<html>
<head>
  <meta charSet="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <link href="/assets/tidy3d/examples/css/example-notebook.css" rel="stylesheet"/>
  <title>Inverse Design of a Mode Converter | Flexcompute</title>
  <script>
    (function () {
      function addWidgetsRenderer() {
        var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
        var scriptElement = document.createElement('script');

        var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';

        var widgetState;

        // Fallback for older version:
        try {
          widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

          if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {

            var widgetRendererSrc = 'https://unpkg.com/@jupyter-js-widgets@*/dist/embed.js';

          }
        } catch (e) {
        }

        scriptElement.src = widgetRendererSrc;
        document.body.appendChild(scriptElement);
      }

      document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
    }());
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"></script>

  <script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();

  </script>

  <script type="module">
    document.addEventListener("DOMContentLoaded", async () => {
      const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
      // do not load mermaidjs if not needed
      if (!diagrams.length) {
        return;
      }
      const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.2.3/mermaid.esm.min.mjs")).default;

      mermaid.initialize({
        maxTextSize: 100000,
        startOnLoad: false,
        fontFamily: window
          .getComputedStyle(document.body)
          .getPropertyValue("--jp-ui-font-family"),
        theme: document.querySelector("body[data-jp-theme-light='true']")
          ? "default"
          : "dark",
      });

      let _nextMermaidId = 0;

      function makeMermaidImage(svg) {
        const img = document.createElement('img');
        const maxWidth = svg.match(/max-width: (\d+)/);
        if (maxWidth && maxWidth[1]) {
          const width = parseInt(maxWidth[1]);
          if (width && !Number.isNaN(width) && Number.isFinite(width)) {
            img.width = width;
          }
        }
        img.setAttribute('src', `data:image/svg+xml,${encodeURIComponent(svg)}`);
        return img;
      }

      async function makeMermaidError(text) {
        let errorMessage = '';
        try {
          await mermaid.parse(text);
        } catch (err) {
          errorMessage = `${err}`;
        }

        const result = document.createElement('details');
        const summary = document.createElement('summary');
        const pre = document.createElement('pre');
        const code = document.createElement('code');
        code.innerText = text;
        pre.appendChild(code);
        summary.appendChild(pre);
        result.appendChild(summary);

        const warning = document.createElement('pre');
        warning.innerText = errorMessage;
        result.appendChild(warning);
        return result;
      }

      async function renderOneMarmaid(src) {
        const id = `jp-mermaid-${_nextMermaidId++}`;
        const parent = src.parentNode;
        let raw = src.textContent.trim();
        const el = document.createElement("div");
        el.style.visibility = "hidden";
        document.body.appendChild(el);
        let result = null;
        try {
          const {svg} = await mermaid.render(id, raw, el);
          result = makeMermaidImage(svg);
        } catch (err) {
          parent.classList.add("jp-mod-warning");
          result = await makeMermaidError(raw);
        } finally {
          el.remove();
        }
        parent.classList.add("jp-RenderedMermaid");
        parent.appendChild(result);
      }

      void Promise.all([...diagrams].map(renderOneMarmaid));
    });
  </script>
  <style>
      .jp-RenderedMarkdown .jp-Mermaid:not(.jp-RenderedMermaid) {
          display: none;
      }

      .jp-RenderedMarkdown .jp-RenderedMermaid.jp-mod-warning {
          width: auto;
          padding: 10px;
          border: var(--jp-border-width) solid var(--jp-warn-color2);
          border-radius: var(--jp-border-radius);
          color: var(--jp-ui-font-color1);
          font-size: var(--jp-ui-font-size1);
          white-space: pre-wrap;
          word-wrap: break-word;
      }

      .jp-RenderedMarkdown .jp-RenderedMermaid.jp-mod-warning details > pre {
          margin-top: 1em;
      }

      .jp-RenderedMarkdown .jp-RenderedMermaid.jp-mod-warning summary {
          color: var(--jp-warn-color2);
      }

      .jp-RenderedMarkdown .jp-RenderedMermaid.jp-mod-warning summary > pre {
          display: inline-block;
      }

      .jp-RenderedMermaid > .mermaid {
          display: none;
      }
  </style>
</head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=23bc2ee3-b625-4b4c-9c87-23dc715ad733">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h2 id="Inverse-design-optimization-of-a-mode-converter-using-fabrication-constraints">Inverse design
          optimization of a mode converter using fabrication constraints<a class="anchor-link"
                                                                           href="#Inverse-design-optimization-of-a-mode-converter-using-fabrication-constraints">¶</a>
        </h2>
        <blockquote>
          <p>To install the <code>jax</code> module required for this feature, we recommend running <code>pip install "tidy3d[jax]"</code>.</p>
        </blockquote>
        <p>In this notebook, we will use inverse design and the Tidy3D <code>adjoint</code> plugin to create an
          integrated photonics component to convert a fundamental waveguide mode to a higher order mode. We introduce
          fabrication constraints through a conical filter followed by a tanh projection.</p>
        <p>For more details on adjoint optimization, we recommend looking at our <a
                href="https://www.flexcompute.com/tidy3d/learning-center/inverse-design/">previous lectures</a> on
          inverse design. You can also reference some of the learning materials in our documentation regarding the
          Tidy3D <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/notebooks/AdjointPlugin1Intro.html">adjoint
            plugin</a>.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs"
     id="cell-id=7257472c-5db1-4b93-8cdb-24b3cc32775d">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [1]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span
                  class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span
                    class="nn">plt</span>

<span class="c1"># import jax to be able to use automatic differentiation</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span
                    class="nn">jnp</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">grad</span><span
                    class="p">,</span> <span class="n">value_and_grad</span>

<span class="c1"># import regular tidy3d</span>
<span class="kn">import</span> <span class="nn">tidy3d</span> <span class="k">as</span> <span
                    class="nn">td</span>
<span class="kn">import</span> <span class="nn">tidy3d.web</span> <span class="k">as</span> <span
                    class="nn">web</span>
<span class="kn">from</span> <span class="nn">tidy3d.plugins.mode</span> <span
                    class="kn">import</span> <span class="n">ModeSolver</span>

<span class="c1"># import the components we need from the adjoint plugin</span>
<span class="kn">from</span> <span class="nn">tidy3d.plugins.adjoint</span> <span
                    class="kn">import</span> <span class="n">JaxSimulation</span><span
                    class="p">,</span> <span class="n">JaxBox</span><span class="p">,</span> <span
                    class="n">JaxCustomMedium</span><span class="p">,</span> <span
                    class="n">JaxStructure</span>
<span class="kn">from</span> <span class="nn">tidy3d.plugins.adjoint</span> <span
                    class="kn">import</span> <span class="n">JaxSimulationData</span><span
                    class="p">,</span> <span class="n">JaxDataArray</span><span class="p">,</span> <span
                    class="n">JaxPermittivityDataset</span>
<span class="kn">from</span> <span class="nn">tidy3d.plugins.adjoint.web</span> <span
                    class="kn">import</span> <span class="n">run</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs"
     id="cell-id=b2c592b4-c210-46e3-94c2-d6a9bfb3ca73">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [2]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="c1"># parameters in the fabrication constraint parameterization function</span>
<span class="n">BETA</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">RADIUS</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># wavelength and frequency</span>
<span class="n">wavelength</span> <span class="o">=</span> <span class="mf">1.55</span>
<span class="n">freq0</span> <span class="o">=</span> <span class="n">td</span><span
                    class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span
                    class="n">wavelength</span>
<span class="n">k0</span> <span class="o">=</span> <span class="mi">2</span> <span
                    class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span
                    class="o">*</span> <span class="n">freq0</span> <span class="o">/</span> <span
                    class="n">td</span><span class="o">.</span><span class="n">C_0</span>

<span class="c1"># resolution control</span>
<span class="n">min_steps_per_wvl</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># space between boxes and PML</span>
<span class="n">buffer</span> <span class="o">=</span> <span class="mf">1.0</span> <span
                    class="o">*</span> <span class="n">wavelength</span>

<span class="c1"># optimize region size</span>
<span class="n">golden_ratio</span> <span class="o">=</span> <span class="mf">1.618</span>
<span class="n">lx</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">ly</span> <span class="o">=</span> <span class="n">lx</span> <span
                    class="o">/</span> <span class="n">golden_ratio</span>
<span class="n">lz</span> <span class="o">=</span> <span class="mf">0.220</span>
<span class="n">wg_width</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># num cells</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span
                    class="p">(</span><span class="n">nx</span> <span class="o">/</span> <span
                    class="n">golden_ratio</span><span class="p">)</span>
<span class="n">num_cells</span> <span class="o">=</span> <span class="n">nx</span> <span
                    class="o">*</span> <span class="n">ny</span>

<span class="c1"># position of source and monitor (constant for all)</span>
<span class="n">source_x</span> <span class="o">=</span> <span class="o">-</span><span
                    class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span
                    class="o">-</span> <span class="n">buffer</span> <span class="o">*</span> <span
                    class="mf">0.8</span>
<span class="n">meas_x</span> <span class="o">=</span> <span class="n">lx</span> <span
                    class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span
                    class="n">buffer</span> <span class="o">*</span> <span class="mf">0.8</span>

<span class="c1"># total size</span>
<span class="n">Lx</span> <span class="o">=</span> <span class="n">lx</span> <span
                    class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span
                    class="n">buffer</span>
<span class="n">Ly</span> <span class="o">=</span> <span class="n">ly</span> <span
                    class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span
                    class="n">buffer</span>
<span class="n">Lz</span> <span class="o">=</span> <span class="n">lz</span> <span
                    class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span
                    class="n">buffer</span>
<span class="n">pml_z</span> <span class="o">=</span> <span class="kc">True</span> <span
                    class="k">if</span> <span class="n">Lz</span> <span class="k">else</span> <span
                    class="kc">False</span>

<span class="c1"># permittivity info</span>
<span class="n">n_si</span> <span class="o">=</span> <span class="mf">3.45</span>
<span class="n">eps_wg</span> <span class="o">=</span> <span class="n">n_si</span> <span
                    class="o">**</span> <span class="mi">2</span>
<span class="n">eps_deviation_random</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">eps_max</span> <span class="o">=</span> <span class="n">eps_wg</span>
<span class="n">eps_sio2</span> <span class="o">=</span> <span class="mf">1.44</span> <span
                    class="o">**</span> <span class="mi">2</span>
<span class="n">dl</span> <span class="o">=</span> <span class="n">wavelength</span> <span
                    class="o">/</span> <span class="n">min_steps_per_wvl</span> <span
                    class="o">/</span> <span class="n">n_si</span>

<span class="c1"># note, we choose the starting permittivities to be uniform with a small, random deviation</span>
<span class="n">params0</span> <span class="o">=</span>  <span class="mf">0.01</span> <span
                    class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span
                    class="n">random</span><span class="o">.</span><span class="n">random</span><span
                    class="p">((</span><span class="n">nx</span><span class="p">,</span> <span
                    class="n">ny</span><span class="p">))</span> <span class="o">-</span> <span
                    class="mf">0.5</span><span class="p">)</span>

<span class="c1"># frequency width and run time</span>
<span class="n">freqw</span> <span class="o">=</span> <span class="n">freq0</span> <span
                    class="o">/</span> <span class="mi">10</span>
<span class="n">run_time</span> <span class="o">=</span> <span class="mi">50</span> <span
                    class="o">/</span> <span class="n">freqw</span>

<span class="c1"># mode in and out</span>
<span class="n">mode_index_in</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mode_index_out</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_modes</span> <span class="o">=</span> <span class="nb">max</span><span
                    class="p">(</span><span class="n">mode_index_in</span><span class="p">,</span> <span
                    class="n">mode_index_out</span><span class="p">)</span> <span class="o">+</span> <span
                    class="mi">1</span>
<span class="n">mode_spec</span> <span class="o">=</span> <span class="n">td</span><span
                    class="o">.</span><span class="n">ModeSpec</span><span class="p">(</span><span
                    class="n">num_modes</span><span class="o">=</span><span class="n">num_modes</span><span
                    class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ac035f60-95f7-4f99-989d-67855acd5b15">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Static-Components">Static Components<a class="anchor-link" href="#Static-Components">¶</a></h3>
        <p>Next, we will set up the static parts of the geometry, the input source, and the output monitor using these
          parameters.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9aa55de4-f748-4939-8b26-9098bb573653">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [3]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">waveguide</span> <span
                  class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span
                  class="p">(</span>
    <span class="n">geometry</span><span class="o">=</span><span class="n">td</span><span
                    class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">size</span><span
                    class="o">=</span><span class="p">(</span><span class="n">td</span><span
                    class="o">.</span><span class="n">inf</span><span class="p">,</span> <span
                    class="n">wg_width</span><span class="p">,</span> <span class="n">lz</span><span
                    class="p">)),</span> <span class="n">medium</span><span class="o">=</span><span
                    class="n">td</span><span class="o">.</span><span class="n">Medium</span><span
                    class="p">(</span><span class="n">permittivity</span><span class="o">=</span><span
                    class="n">eps_wg</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">substrate</span> <span class="o">=</span> <span class="n">td</span><span
                    class="o">.</span><span class="n">Structure</span><span class="p">(</span>
    <span class="n">geometry</span><span class="o">=</span><span class="n">td</span><span
                    class="o">.</span><span class="n">Box</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span
                    class="n">td</span><span class="o">.</span><span class="n">inf</span><span
                    class="p">,</span> <span class="n">td</span><span class="o">.</span><span class="n">inf</span><span
                    class="p">,</span> <span class="n">Lz</span><span class="p">),</span>
        <span class="n">center</span><span class="o">=</span><span class="p">(</span><span
                    class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span
                    class="p">,</span> <span class="o">-</span><span class="n">Lz</span><span class="o">/</span><span
                    class="mi">2</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">td</span><span
                    class="o">.</span><span class="n">Medium</span><span class="p">(</span><span
                    class="n">permittivity</span><span class="o">=</span><span
                    class="n">eps_sio2</span><span class="p">)</span>
<span class="p">)</span>


<span class="n">mode_size</span> <span class="o">=</span> <span class="p">(</span><span
                    class="mi">0</span><span class="p">,</span> <span class="n">wg_width</span> <span
                    class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span
                    class="n">lz</span> <span class="o">*</span> <span class="mi">4</span><span
                    class="p">)</span>

<span class="c1"># source seeding the simulation</span>
<span class="n">forward_source</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span
                    class="n">ModeSource</span><span class="p">(</span>
    <span class="n">source_time</span><span class="o">=</span><span class="n">td</span><span
                    class="o">.</span><span class="n">GaussianPulse</span><span class="p">(</span><span
                    class="n">freq0</span><span class="o">=</span><span class="n">freq0</span><span
                    class="p">,</span> <span class="n">fwidth</span><span class="o">=</span><span
                    class="n">freqw</span><span class="p">),</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="n">source_x</span><span
                    class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
                    class="mi">0</span><span class="p">],</span>
    <span class="n">size</span><span class="o">=</span><span class="n">mode_size</span><span
                    class="p">,</span>
    <span class="n">mode_index</span><span class="o">=</span><span class="n">mode_index_in</span><span
                    class="p">,</span>
    <span class="n">mode_spec</span><span class="o">=</span><span class="n">mode_spec</span><span
                    class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="s2">"+"</span><span
                    class="p">,</span>
<span class="p">)</span>

<span class="c1"># we'll refer to the measurement monitor by this name often</span>
<span class="n">measurement_monitor_name</span> <span class="o">=</span> <span
                    class="s2">"measurement"</span>

<span class="c1"># monitor where we compute the objective function from</span>
<span class="n">measurement_monitor</span> <span class="o">=</span> <span class="n">td</span><span
                    class="o">.</span><span class="n">ModeMonitor</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">[</span><span
                    class="n">meas_x</span><span class="p">,</span> <span class="mi">0</span><span
                    class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">size</span><span class="o">=</span><span class="n">mode_size</span><span
                    class="p">,</span>
    <span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span
                    class="n">freq0</span><span class="p">],</span>
    <span class="n">mode_spec</span><span class="o">=</span><span class="n">mode_spec</span><span
                    class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="n">measurement_monitor_name</span><span
                    class="p">,</span>
<span class="p">)</span>

<span class="c1"># field monitor</span>
<span class="n">fld_mnt</span> <span class="o">=</span> <span class="n">td</span><span
                    class="o">.</span><span class="n">FieldMonitor</span><span class="p">(</span>
    <span class="n">center</span><span class="o">=</span><span class="p">(</span><span
                    class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span
                    class="mi">0</span><span class="p">),</span>
    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">td</span><span
                    class="o">.</span><span class="n">inf</span><span class="p">,</span> <span
                    class="n">td</span><span class="o">.</span><span class="n">inf</span><span
                    class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span
                    class="n">freq0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"field"</span><span
                    class="p">,</span>
<span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:04] </span><span
        style="color: #800000; text-decoration-color: #800000">WARNING: Default value for the field monitor          </span> <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/components/monitor.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">monitor.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/components/monitor.py#261"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">261</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'colocate'</span><span
          style="color: #800000; text-decoration-color: #800000"> setting has changed to </span><span
          style="color: #008000; text-decoration-color: #008000">'True'</span><span
          style="color: #800000; text-decoration-color: #800000"> in Tidy3D    </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">              </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.4</span><span
          style="color: #800000; text-decoration-color: #800000">.</span><span
          style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span><span
          style="color: #800000; text-decoration-color: #800000">. All field components will be colocated to the  </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">              </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #800000; text-decoration-color: #800000">grid boundaries. Set to </span><span
          style="color: #008000; text-decoration-color: #008000">'False'</span><span
          style="color: #800000; text-decoration-color: #800000"> to get the raw fields </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">              </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #800000; text-decoration-color: #800000">on the Yee grid instead.                              </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">              </span>
</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=afe16823-2271-4773-b0e3-a5ce3788ecae">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Input-Structures">Input Structures<a class="anchor-link" href="#Input-Structures">¶</a></h3>
        <p>Next, we write a function to return the pixellated array of permittivity values given our parameters using <a
                href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.plugins.adjoint.JaxCustomMedium.html?highlight=JaxCustomMedium#tidy3d.plugins.adjoint.JaxCustomMedium">JaxCustomMedium</a>.
        </p>
        <p>We'll first apply a <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.plugins.adjoint.utils.filter.ConicFilter.html">ConicFilter</a>
          to the raw parameters and then apply a <a
                  href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.plugins.adjoint.utils.filter.BinaryProjector.html">BinaryProjector</a> to give
          the permittivity values.</p>
        <p>We will feed the result of this function to our <code>JaxSimulation.input_structures</code> and will take the
          gradient w.r.t. the inputs.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs"
     id="cell-id=2d3e00d9-35f1-4e83-807c-66102b96ed5a">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [4]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span
                  class="nn">tidy3d.plugins.adjoint.utils.filter</span> <span class="kn">import</span> <span
                  class="n">ConicFilter</span><span class="p">,</span> <span
                  class="n">BinaryProjector</span>

<span class="k">def</span> <span class="nf">make_input_structures</span><span class="p">(</span><span
                    class="n">params</span><span class="p">:</span> <span class="n">jnp</span><span
                    class="o">.</span><span class="n">array</span><span class="p">)</span> <span
                    class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span
                    class="n">JaxStructure</span><span class="p">]:</span>

    <span class="n">size_box_x</span> <span class="o">=</span> <span class="nb">float</span><span
                    class="p">(</span><span class="n">lx</span><span class="p">)</span> <span class="o">/</span> <span
                    class="n">nx</span>
    <span class="n">size_box_y</span> <span class="o">=</span> <span class="nb">float</span><span
                    class="p">(</span><span class="n">ly</span><span class="p">)</span> <span class="o">/</span> <span
                    class="n">ny</span>
    <span class="n">size_box</span> <span class="o">=</span> <span class="p">(</span><span class="n">size_box_x</span><span
                    class="p">,</span> <span class="n">size_box_y</span><span class="p">,</span> <span
                    class="n">lz</span><span class="p">)</span>

    <span class="n">x0_min</span> <span class="o">=</span> <span class="o">-</span><span
                    class="n">lx</span> <span class="o">/</span> <span class="mi">2</span> <span
                    class="o">+</span> <span class="n">size_box_x</span> <span class="o">/</span> <span
                    class="mi">2</span>
    <span class="n">y0_min</span> <span class="o">=</span> <span class="o">-</span><span
                    class="n">ly</span> <span class="o">/</span> <span class="mi">2</span> <span
                    class="o">+</span> <span class="n">size_box_y</span> <span class="o">/</span> <span
                    class="mi">2</span>

    <span class="n">input_structures</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">coords_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0_min</span> <span
                    class="o">+</span> <span class="n">index_x</span> <span class="o">*</span> <span
                    class="n">size_box_x</span> <span class="o">-</span> <span class="mf">1e-5</span> <span
                    class="k">for</span> <span class="n">index_x</span> <span class="ow">in</span> <span
                    class="nb">range</span><span class="p">(</span><span class="n">nx</span><span
                    class="p">)]</span>
    <span class="n">coords_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0_min</span> <span
                    class="o">+</span> <span class="n">index_y</span> <span class="o">*</span> <span
                    class="n">size_box_y</span> <span class="o">-</span> <span class="mf">1e-5</span> <span
                    class="k">for</span> <span class="n">index_y</span> <span class="ow">in</span> <span
                    class="nb">range</span><span class="p">(</span><span class="n">ny</span><span
                    class="p">)]</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="nb">dict</span><span
                    class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coords_x</span><span
                    class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">coords_y</span><span
                    class="p">,</span> <span class="n">z</span><span class="o">=</span><span
                    class="p">[</span><span class="mi">0</span><span class="p">],</span> <span
                    class="n">f</span><span class="o">=</span><span class="p">[</span><span class="n">freq0</span><span
                    class="p">])</span>

    <span class="k">if</span> <span class="n">RADIUS</span><span class="p">:</span>
        <span class="n">conic_filter</span> <span class="o">=</span> <span class="n">ConicFilter</span><span
                    class="p">(</span><span class="n">radius</span><span class="o">=</span><span
                    class="n">RADIUS</span><span class="p">,</span> <span
                    class="n">design_region_dl</span><span class="o">=</span><span
                    class="n">size_box_x</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">conic_filter</span><span
                    class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span
                    class="n">params</span><span class="p">)</span>

    <span class="n">params_01</span> <span class="o">=</span> <span class="mf">0.5</span> <span
                    class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span
                    class="o">.</span><span class="n">tanh</span><span class="p">(</span><span
                    class="n">params</span> <span class="o">*</span> <span class="n">BETA</span><span
                    class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span
                    class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">eps_wg</span> <span
                    class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span
                    class="o">*</span> <span class="n">params_01</span> <span class="o">+</span> <span
                    class="mf">1.05</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span
                    class="n">reshape</span><span class="p">((</span><span class="n">nx</span><span
                    class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span
                    class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span
                    class="p">))</span>

    <span class="n">field_components</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sa">f</span><span class="s2">"eps_</span><span class="si">{</span><span class="n">dim</span><span
                    class="si">}{</span><span class="n">dim</span><span class="si">}</span><span
                    class="s2">"</span><span class="p">:</span> <span class="n">JaxDataArray</span><span
                    class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">params</span><span
                    class="p">,</span> <span class="n">coords</span><span class="o">=</span><span
                    class="n">coords</span><span class="p">)</span> <span class="k">for</span> <span
                    class="n">dim</span> <span class="ow">in</span> <span class="s2">"xyz"</span>
    <span class="p">}</span>
    <span class="n">eps_dataset</span> <span class="o">=</span> <span class="n">JaxPermittivityDataset</span><span
                    class="p">(</span><span class="o">**</span><span class="n">field_components</span><span
                    class="p">)</span>
    <span class="n">custom_medium</span> <span class="o">=</span> <span class="n">JaxCustomMedium</span><span class="p">(</span><span
                    class="n">eps_dataset</span><span class="o">=</span><span class="n">eps_dataset</span><span
                    class="p">)</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">JaxBox</span><span class="p">(</span><span
                    class="n">center</span><span class="o">=</span><span class="p">(</span><span
                    class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
                    class="mi">0</span><span class="p">),</span> <span class="n">size</span><span
                    class="o">=</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span
                    class="n">ly</span><span class="p">,</span> <span class="n">lz</span><span class="p">))</span>
    <span class="n">custom_structure</span> <span class="o">=</span> <span class="n">JaxStructure</span><span class="p">(</span><span
                    class="n">geometry</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span
                    class="n">medium</span><span class="o">=</span><span class="n">custom_medium</span><span
                    class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">custom_structure</span><span
                    class="p">]</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=75983c02-ca0f-4dcb-9c51-04ce9b5ac7ed">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Jax-Simulation">Jax Simulation<a class="anchor-link" href="#Jax-Simulation">¶</a></h3>
        <p>Next, we write a function to return the <code>JaxSimulation</code> as a function of our parameters.</p>
        <p>We make sure to add the pixellated <code>JaxStructure</code> list to <code>input_structures</code> and the
          <code>measurement_monitor</code> to <code>output_monitors</code>.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=3b09827b-a607-4631-977d-466f732e1d90">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [5]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span
                  class="nf">make_sim</span><span class="p">(</span><span class="n">params</span><span
                  class="p">)</span> <span class="o">-&gt;</span> <span class="n">JaxSimulation</span><span
                  class="p">:</span>

    <span class="n">input_structures</span> <span class="o">=</span> <span class="n">make_input_structures</span><span
                    class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">JaxSimulation</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">Lx</span><span
                    class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">Lz</span><span
                    class="p">],</span>
        <span class="n">grid_spec</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span
                    class="n">GridSpec</span><span class="o">.</span><span class="n">auto</span><span class="p">(</span><span
                    class="n">min_steps_per_wvl</span><span class="o">=</span><span
                    class="n">min_steps_per_wvl</span><span class="p">),</span>
        <span class="n">structures</span><span class="o">=</span><span class="p">[</span><span
                    class="n">waveguide</span><span class="p">,</span> <span class="n">substrate</span><span class="p">],</span>
        <span class="n">input_structures</span><span class="o">=</span><span class="n">input_structures</span><span
                    class="p">,</span>
        <span class="n">sources</span><span class="o">=</span><span class="p">[</span><span
                    class="n">forward_source</span><span class="p">],</span>
        <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span
                    class="n">fld_mnt</span><span class="p">],</span>
        <span class="n">output_monitors</span><span class="o">=</span><span class="p">[</span><span class="n">measurement_monitor</span><span
                    class="p">],</span>
        <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
        <span class="n">subpixel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">boundary_spec</span><span class="o">=</span><span class="n">td</span><span
                    class="o">.</span><span class="n">BoundarySpec</span><span class="o">.</span><span
                    class="n">pml</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span
                    class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span
                    class="kc">True</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span
                    class="n">pml_z</span><span class="p">),</span>
        <span class="n">shutoff</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
        <span class="n">courant</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2e7cd9e9-a41a-4353-a0ee-cec464bc2f2d">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Visualize">Visualize<a class="anchor-link" href="#Visualize">¶</a></h3>
        <p>Let's visualize the simulation to see how it looks</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=ae07fed6-c0e4-415a-8a55-58f1b02bd311">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [6]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_start</span> <span class="o">=</span> <span
                  class="n">make_sim</span><span class="p">(</span><span class="n">params0</span><span
                  class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sim_start</span><span class="o">.</span><span
                    class="n">plot_eps</span><span class="p">(</span><span class="n">z</span><span
                    class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sim_start</span><span class="o">.</span><span
                    class="n">plot_eps</span><span class="p">(</span><span class="n">x</span><span
                    class="o">=-</span><span class="mf">2.8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_1.png" alt="cross section at z=0.10"/>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_2.png" alt="cross section at x=-0.80"/>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5dc853c5-a191-4602-bf5b-7fa8761d51f1">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Select-Input-and-Output-Modes">Select Input and Output Modes<a class="anchor-link"
                                                                               href="#Select-Input-and-Output-Modes">¶</a>
        </h3>
        <p>Next, let's visualize the mode profiles so we can inspect which mode indices we want to inject and
          transmit.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=eb91e8b8-af55-4e99-9134-b3320621dbb9">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [7]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">mode_solver</span> <span
                  class="o">=</span> <span class="n">ModeSolver</span><span class="p">(</span>
    <span class="n">simulation</span><span class="o">=</span><span class="n">sim_start</span><span
                    class="p">,</span> <span class="n">plane</span><span class="o">=</span><span class="n">forward_source</span><span
                    class="p">,</span> <span class="n">mode_spec</span><span class="o">=</span><span
                    class="n">mode_spec</span><span class="p">,</span> <span class="n">freqs</span><span
                    class="o">=</span><span class="p">[</span><span class="n">freq0</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">modes</span> <span class="o">=</span> <span class="n">mode_solver</span><span class="o">.</span><span
                    class="n">solve</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Effective index of computed modes: "</span><span
                    class="p">,</span> <span class="n">np</span><span class="o">.</span><span
                    class="n">array</span><span class="p">(</span><span class="n">modes</span><span
                    class="o">.</span><span class="n">n_eff</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span
                    class="o">.</span><span class="n">subplots</span><span class="p">(</span><span
                    class="n">num_modes</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span
                    class="n">figsize</span><span class="o">=</span><span class="p">(</span><span
                    class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span
                    class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span
                    class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mode_ind</span> <span class="ow">in</span> <span class="nb">range</span><span
                    class="p">(</span><span class="n">num_modes</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">field_ind</span><span class="p">,</span> <span
                    class="n">field_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span
                    class="p">((</span><span class="s2">"Ex"</span><span class="p">,</span> <span class="s2">"Ey"</span><span
                    class="p">,</span> <span class="s2">"Ez"</span><span class="p">)):</span>
        <span class="n">field</span> <span class="o">=</span> <span class="n">modes</span><span class="o">.</span><span
                    class="n">field_components</span><span class="p">[</span><span class="n">field_name</span><span
                    class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span
                    class="n">mode_index</span><span class="o">=</span><span class="n">mode_ind</span><span
                    class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span
                    class="n">mode_ind</span><span class="p">,</span> <span class="n">field_ind</span><span
                    class="p">]</span>
        <span class="n">field</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span
                    class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span
                    class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span
                    class="s1">''</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:05] </span><span
        style="color: #800000; text-decoration-color: #800000">WARNING: Use the remote mode solver with subpixel </span> <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/plugins/mode/mode_solver.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">mode_solver.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/plugins/mode/mode_solver.py#154"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">154</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #800000; text-decoration-color: #800000">averaging for better accuracy through             </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'tidy3d.plugins.mode.web.run(...)'</span><span
          style="color: #800000; text-decoration-color: #800000">.               </span> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Effective index of computed modes:  [[2.0610273 1.6198782]]
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_3.png" alt="Effective index of computed modes:  [[2.0610273 1.6198782]]"/>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d5a09ce7-4e64-4ccb-8a8f-54c23c5c7d4a">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <p>Aftert inspection, we decide to inject the fundamental, Ey-polarized input into the 1st order Ey-polarized
          input.</p>
        <p>From the plots, we see that these modes correspond to the first and third rows, or <code>mode_index=0</code>
          and <code>mode_index=1</code>, respectively.</p>
        <p>So we make sure that the <code>mode_index_in</code> and <code>mode_index_out</code> variables are set
          appropriately.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=61522716-a26f-400b-a005-5d9493ef7264">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Post-Processing">Post Processing<a class="anchor-link" href="#Post-Processing">¶</a></h3>
        <p>We will define one more function to tell us how we want to postprocess a <code>JaxSimulationData</code>
          object to give the conversion power that we are interested in maximizing.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=2081ff1b-46fe-4bb0-9027-8c4ca0a359bd">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [8]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span
                  class="nf">measure_power</span><span class="p">(</span><span class="n">sim_data</span><span class="p">:</span> <span
                  class="n">JaxSimulationData</span><span class="p">)</span> <span class="o">-&gt;</span> <span
                  class="nb">float</span><span class="p">:</span>
    <span class="sd">"""Return the power in the output_data amplitude at the mode index of interest."""</span>
    <span class="n">output_amps</span> <span class="o">=</span> <span class="n">sim_data</span><span
                    class="p">[</span><span class="n">measurement_monitor_name</span><span class="p">]</span><span
                    class="o">.</span><span class="n">amps</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">output_amps</span><span class="o">.</span><span
                    class="n">sel</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span
                    class="s2">"+"</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span
                    class="n">freq0</span><span class="p">,</span> <span class="n">mode_index</span><span
                    class="o">=</span><span class="n">mode_index_out</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span
                    class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span
                    class="p">(</span><span class="n">amp</span><span class="p">)</span> <span class="o">**</span> <span
                    class="mi">2</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5863a5c3-3b5e-4927-9e18-749b660e7c3f">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Define-Objective-Function">Define Objective Function<a class="anchor-link"
                                                                       href="#Define-Objective-Function">¶</a></h3>
        <p>Finally, we need to define the objective function that we want to maximize as a function of our input
          parameters that returns the conversion power. This is the function we will differentiate later.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=71c5b2ed-a036-4578-ad44-89aa70f59e28">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [9]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">J</span><span
                  class="p">(</span><span class="n">params</span><span class="p">,</span> <span
                  class="n">step_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span
                  class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span
                  class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span
                  class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="n">make_sim</span><span class="p">(</span><span
                    class="n">params</span><span class="p">)</span>
    <span class="n">task_name</span> <span class="o">=</span> <span class="s2">"inv_des"</span>
    <span class="k">if</span> <span class="n">step_num</span><span class="p">:</span>
        <span class="n">task_name</span> <span class="o">+=</span> <span class="sa">f</span><span
                    class="s2">"_step_</span><span class="si">{</span><span class="n">step_num</span><span
                    class="si">}</span><span class="s2">"</span>
    <span class="n">sim_data</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span
                    class="n">sim</span><span class="p">,</span> <span class="n">task_name</span><span
                    class="o">=</span><span class="n">task_name</span><span class="p">,</span> <span
                    class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span
                    class="p">)</span>
    <span class="k">return</span> <span class="n">measure_power</span><span class="p">(</span><span
                    class="n">sim_data</span><span class="p">),</span> <span class="n">sim_data</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=075f3d66-c98f-4410-829a-b178464de0b8">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h2 id="Inverse-Design">Inverse Design<a class="anchor-link" href="#Inverse-Design">¶</a></h2>
        <p>Now we are ready to perform the optimization.</p>
        <p>We use the <code>jax.value_and_grad</code> function to get the gradient of <code>J</code> with respect to the
          permittivity of each <code>Box</code>, while also returning the converted power associated with the current
          iteration, so we can record this value for later.</p>
        <p>Let's try running this function once to make sure it works.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=9ee539ec-11a2-4107-8270-9d58c7607562">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [10]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">dJ_fn</span> <span
                  class="o">=</span> <span class="n">value_and_grad</span><span class="p">(</span><span
                  class="n">J</span><span class="p">,</span> <span class="n">has_aux</span><span class="o">=</span><span
                  class="kc">True</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9c60dfdf-3518-44ce-b658-ea192950aa83">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [11]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">val</span><span
                  class="p">,</span> <span class="n">data</span><span class="p">),</span> <span
                  class="n">grad</span> <span class="o">=</span> <span class="n">dJ_fn</span><span
                  class="p">(</span><span class="n">params0</span><span class="p">,</span> <span
                  class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grad</span><span class="o">.</span><span class="n">shape</span><span
                    class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:07] </span>Created task <span
        style="color: #008000; text-decoration-color: #008000">'inv_des'</span> with task_id                     <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#188" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">188</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'fdve-70c431fe-b001-4bd0-9362-bf0d41a56b7bv1'</span>.          <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>View task using web UI at                               <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#190" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">190</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><a
          href="https://tidy3d.simulation.cloud/workbench?taskId=fdve-70c431fe-b001-4bd0-9362-bf0d41a56b7bv1"
          target="_blank"><span style="color: #008000; text-decoration-color: #008000">'https://tidy3d.simulation.cloud/workbench?taskId=fdve-</span></a> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><a
          href="https://tidy3d.simulation.cloud/workbench?taskId=fdve-70c431fe-b001-4bd0-9362-bf0d41a56b7bv1"
          target="_blank"><span style="color: #008000; text-decoration-color: #008000">70c431fe-b001-4bd0-9362-bf0d41a56b7bv1'</span></a>.                <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:15] </span>status = queued                                         <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#361" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">361</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:24] </span>status = preprocess                                     <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#355" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">355</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:37:30] </span>Maximum FlexCredit cost: <span
        style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.515</span>. Use                     <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#341" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">341</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'web.real_cost(task_id)'</span> to get the billed FlexCredit   <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>cost after a simulation run.                            <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>starting up solver                                      <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#377" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">377</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>running solver                                          <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#386" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">386</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>To cancel the simulation, use <span
        style="color: #008000; text-decoration-color: #008000">'web.abort(task_id)'</span> or   <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#387" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">387</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'web.delete(task_id)'</span> or abort/delete the task in the   <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>web UI. Terminating the Python script will not stop the <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>job running on the cloud.                               <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:38:29] </span>early shutoff detected, exiting.                        <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#404" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">404</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>status = postprocess                                    <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#420" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">420</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:38:48] </span>status = success                                        <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#427" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">427</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:38:50] </span>loading SimulationData from simulation_data.hdf5        <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#591" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">591</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>Created task <span
        style="color: #008000; text-decoration-color: #008000">'inv_des_adj'</span> with task_id                 <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#188" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">188</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'fdve-1c041d20-85bf-40c1-a785-81bfdabf2aaav1'</span>.          <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>View task using web UI at                               <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#190" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">190</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><a
          href="https://tidy3d.simulation.cloud/workbench?taskId=fdve-1c041d20-85bf-40c1-a785-81bfdabf2aaav1"
          target="_blank"><span style="color: #008000; text-decoration-color: #008000">'https://tidy3d.simulation.cloud/workbench?taskId=fdve-</span></a> <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><a
          href="https://tidy3d.simulation.cloud/workbench?taskId=fdve-1c041d20-85bf-40c1-a785-81bfdabf2aaav1"
          target="_blank"><span style="color: #008000; text-decoration-color: #008000">1c041d20-85bf-40c1-a785-81bfdabf2aaav1'</span></a>.                <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:38:53] </span>status = queued                                         <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#361" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">361</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:38:57] </span>status = preprocess                                     <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#355" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">355</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:39:02] </span>Maximum FlexCredit cost: <span
        style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.514</span>. Use                     <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#341" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">341</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'web.real_cost(task_id)'</span> to get the billed FlexCredit   <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>cost after a simulation run.                            <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>starting up solver                                      <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#377" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">377</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>running solver                                          <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#386" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">386</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>To cancel the simulation, use <span
        style="color: #008000; text-decoration-color: #008000">'web.abort(task_id)'</span> or   <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#387" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">387</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span><span
          style="color: #008000; text-decoration-color: #008000">'web.delete(task_id)'</span> or abort/delete the task in the   <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>web UI. Terminating the Python script will not stop the <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>job running on the cloud.                               <span
          style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:39:30] </span>early shutoff detected, exiting.                        <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#404" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">404</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>status = postprocess                                    <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#420" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">420</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span
        style="color: #7fbfbf; text-decoration-color: #7fbfbf">[12:39:35] </span>status = success                                        <a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py"
        target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">webapi.py</span></a><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a
        href="file:///Users/twhughes/Documents/Flexcompute/tidy3d-docs/tidy3d/tidy3d/web/webapi.py#427" target="_blank"><span
        style="color: #7f7f7f; text-decoration-color: #7f7f7f">427</span></a>
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>Output()</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
          <pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>(120, 74)
</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=6d9baa10-2962-4d12-a9db-5cde96b84791">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [12]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">val</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child jp-OutputArea-executeResult">
        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[12]:</div>
        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
          <pre>Array(0.00057049, dtype=float32)</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=529fad9d-3692-464b-9a45-bea3e084c1b5">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Optimization">Optimization<a class="anchor-link" href="#Optimization">¶</a></h3>
        <p>We will use "Adam" optimization strategy to perform sequential updates of each of the permittivity values in
          the
          <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.plugins.adjoint.JaxCustomMedium.html?highlight=JaxCustomMedium#tidy3d.plugins.adjoint.JaxCustomMedium">JaxCustomMedium</a>.
        </p>
        <p>For more information on what we use to implement this method, see <a
                href="https://optimization.cbe.cornell.edu/index.php?title=Adam">this article</a>.</p>
        <p>We will run 10 steps and measure both the permittivities and powers at each iteration.</p>
        <p>We capture this process in an <code>optimize</code> function, which accepts various parameters that we can
          tweak.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=3eedf09a-9265-43ec-a557-3d0ec5b774bb">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [13]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span
                  class="nn">optax</span>

<span class="n">td</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">logging_level</span> <span
                    class="o">=</span> <span class="s2">"ERROR"</span>

<span class="c1"># hyperparameters</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">25e-4</span>

<span class="c1"># initialize adam optimizer with starting parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span
                    class="p">(</span><span class="n">params0</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span
                    class="n">adam</span><span class="p">(</span><span class="n">learning_rate</span><span
                    class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
<span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span
                    class="n">init</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># store history</span>
<span class="n">Js</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">params_history</span> <span class="o">=</span> <span class="p">[</span><span
                    class="n">params</span><span class="p">]</span>
<span class="n">data_history</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span
                    class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span
                    class="p">(</span><span class="n">num_steps</span><span class="p">):</span>

    <span class="c1"># compute gradient and current objective funciton value</span>
    <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">data</span><span
                    class="p">),</span> <span class="n">gradient</span> <span class="o">=</span> <span
                    class="n">dJ_fn</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span
                    class="n">step_num</span><span class="o">=</span><span class="n">i</span><span
                    class="o">+</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># outputs</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"step = </span><span
                    class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span
                    class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span
                    class="se">\t</span><span class="s2">J = </span><span class="si">{</span><span
                    class="n">value</span><span class="si">:</span><span class="s2">.4e</span><span
                    class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span
                    class="se">\t</span><span class="s2">grad_norm = </span><span class="si">{</span><span
                    class="n">np</span><span class="o">.</span><span class="n">linalg</span><span
                    class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">gradient</span><span
                    class="p">)</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span
                    class="s2">"</span><span class="p">)</span>

    <span class="c1"># compute and apply updates to the optimizer based on gradient (-1 sign to maximize obj_fn)</span>
    <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span
                    class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span
                    class="n">update</span><span class="p">(</span><span class="o">-</span><span
                    class="n">gradient</span><span class="p">,</span> <span class="n">opt_state</span><span
                    class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span
                    class="n">apply_updates</span><span class="p">(</span><span class="n">params</span><span
                    class="p">,</span> <span class="n">updates</span><span class="p">)</span>

    <span class="c1"># save history</span>
    <span class="n">Js</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                    class="n">value</span><span class="p">)</span>
    <span class="n">params_history</span><span class="o">.</span><span class="n">append</span><span
                    class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">data_history</span><span class="o">.</span><span class="n">append</span><span
                    class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>step = 1
	J = 5.7048e-04
	grad_norm = 7.1980e-01
step = 2
	J = 5.8271e-02
	grad_norm = 3.2094e+00
step = 3
	J = 1.8351e-01
	grad_norm = 6.5283e+00
step = 4
	J = 2.9831e-01
	grad_norm = 6.8098e+00
step = 5
	J = 3.7441e-01
	grad_norm = 4.5694e+00
step = 6
	J = 2.5480e-01
	grad_norm = 4.0456e+00
step = 7
	J = 2.8951e-01
	grad_norm = 3.4236e+00
step = 8
	J = 3.6417e-01
	grad_norm = 2.4072e+00
step = 9
	J = 4.0927e-01
	grad_norm = 1.4756e+00
step = 10
	J = 4.0717e-01
	grad_norm = 2.1635e+00
step = 11
	J = 4.0322e-01
	grad_norm = 2.7579e+00
step = 12
	J = 4.2978e-01
	grad_norm = 2.5637e+00
step = 13
	J = 4.7454e-01
	grad_norm = 1.8433e+00
step = 14
	J = 5.1639e-01
	grad_norm = 1.4946e+00
step = 15
	J = 5.5091e-01
	grad_norm = 1.1112e+00
step = 16
	J = 5.5076e-01
	grad_norm = 1.3412e+00
step = 17
	J = 5.4971e-01
	grad_norm = 1.5222e+00
step = 18
	J = 5.5867e-01
	grad_norm = 1.5042e+00
step = 19
	J = 5.7811e-01
	grad_norm = 1.3299e+00
step = 20
	J = 6.0190e-01
	grad_norm = 1.1056e+00
step = 21
	J = 6.2367e-01
	grad_norm = 8.8847e-01
step = 22
	J = 6.3966e-01
	grad_norm = 7.7817e-01
step = 23
	J = 6.5028e-01
	grad_norm = 8.4007e-01
step = 24
	J = 6.5917e-01
	grad_norm = 9.3976e-01
step = 25
	J = 6.6967e-01
	grad_norm = 9.3501e-01
step = 26
	J = 6.7108e-01
	grad_norm = 1.0764e+00
step = 27
	J = 6.7766e-01
	grad_norm = 1.0326e+00
step = 28
	J = 6.8828e-01
	grad_norm = 8.3363e-01
step = 29
	J = 6.9897e-01
	grad_norm = 5.4822e-01
step = 30
	J = 7.0591e-01
	grad_norm = 3.2599e-01
step = 31
	J = 7.0780e-01
	grad_norm = 4.5388e-01
step = 32
	J = 7.0682e-01
	grad_norm = 6.5268e-01
step = 33
	J = 7.0634e-01
	grad_norm = 7.0469e-01
step = 34
	J = 7.0759e-01
	grad_norm = 6.5637e-01
step = 35
	J = 7.0991e-01
	grad_norm = 6.0179e-01
step = 36
	J = 7.0695e-01
	grad_norm = 8.4391e-01
step = 37
	J = 7.0813e-01
	grad_norm = 7.4822e-01
step = 38
	J = 7.1192e-01
	grad_norm = 6.5498e-01
step = 39
	J = 7.1648e-01
	grad_norm = 7.1992e-01
step = 40
	J = 7.2240e-01
	grad_norm = 5.7227e-01
step = 41
	J = 7.2778e-01
	grad_norm = 4.7710e-01
step = 42
	J = 7.3241e-01
	grad_norm = 4.8525e-01
step = 43
	J = 7.3685e-01
	grad_norm = 3.3807e-01
step = 44
	J = 7.3971e-01
	grad_norm = 3.6552e-01
step = 45
	J = 7.4169e-01
	grad_norm = 5.4077e-01
step = 46
	J = 7.4515e-01
	grad_norm = 5.1662e-01
step = 47
	J = 7.4963e-01
	grad_norm = 3.8266e-01
step = 48
	J = 7.5354e-01
	grad_norm = 3.8529e-01
step = 49
	J = 7.5739e-01
	grad_norm = 4.5926e-01
step = 50
	J = 7.6220e-01
	grad_norm = 4.4518e-01
</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=30ce10a9-526c-434a-8606-f31c33949a41">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [14]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">params_after</span> <span
                  class="o">=</span> <span class="n">params_history</span><span class="p">[</span><span
                  class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=e0b44fda-bf57-42cf-8370-05bf20de96df">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <h3 id="Results">Results<a class="anchor-link" href="#Results">¶</a></h3>
        <p>First, we plot the objective function as a function of step and notice that it converges nicely!</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=bc757643-2b71-4394-8fa6-f24c305848af">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [15]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span
                  class="n">plot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span
                  class="n">array</span><span class="p">(</span><span class="n">Js</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"iterations"</span><span
                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"objective function"</span><span
                    class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_4.png" alt="objective function"/>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d5f9f039-5cf5-4e21-a27e-b426fb679e88">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [16]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">Js</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child jp-OutputArea-executeResult">
        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>
        <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>[Array(0.00057048, dtype=float32),
 Array(0.05827059, dtype=float32),
 Array(0.18350816, dtype=float32),
 Array(0.29830727, dtype=float32),
 Array(0.3744134, dtype=float32),
 Array(0.25479904, dtype=float32),
 Array(0.2895097, dtype=float32),
 Array(0.36417153, dtype=float32),
 Array(0.4092735, dtype=float32),
 Array(0.4071658, dtype=float32),
 Array(0.40322325, dtype=float32),
 Array(0.42977965, dtype=float32),
 Array(0.4745363, dtype=float32),
 Array(0.5163853, dtype=float32),
 Array(0.55091274, dtype=float32),
 Array(0.5507563, dtype=float32),
 Array(0.54970896, dtype=float32),
 Array(0.55866563, dtype=float32),
 Array(0.57811373, dtype=float32),
 Array(0.6018991, dtype=float32),
 Array(0.6236749, dtype=float32),
 Array(0.6396642, dtype=float32),
 Array(0.650282, dtype=float32),
 Array(0.659171, dtype=float32),
 Array(0.6696716, dtype=float32),
 Array(0.6710839, dtype=float32),
 Array(0.67766047, dtype=float32),
 Array(0.6882825, dtype=float32),
 Array(0.6989677, dtype=float32),
 Array(0.70590943, dtype=float32),
 Array(0.70780003, dtype=float32),
 Array(0.7068219, dtype=float32),
 Array(0.70633996, dtype=float32),
 Array(0.70758593, dtype=float32),
 Array(0.70990896, dtype=float32),
 Array(0.70695156, dtype=float32),
 Array(0.7081289, dtype=float32),
 Array(0.71192354, dtype=float32),
 Array(0.7164821, dtype=float32),
 Array(0.7223976, dtype=float32),
 Array(0.72777903, dtype=float32),
 Array(0.73240846, dtype=float32),
 Array(0.7368534, dtype=float32),
 Array(0.73971343, dtype=float32),
 Array(0.74168736, dtype=float32),
 Array(0.7451518, dtype=float32),
 Array(0.749627, dtype=float32),
 Array(0.7535403, dtype=float32),
 Array(0.7573899, dtype=float32),
 Array(0.7621993, dtype=float32)]</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=26d5312b-d4ab-4621-bcc9-dfc0f22a5ce1">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [17]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span
                  class="p">(</span><span class="sa">f</span><span class="s2">"Initial power conversion = </span><span
                  class="si">{</span><span class="n">Js</span><span class="p">[</span><span class="mi">0</span><span
                  class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span
                  class="s2">.2f</span><span class="si">}</span><span class="s2"> %"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span
                    class="s2">"Final power conversion = </span><span class="si">{</span><span class="n">Js</span><span
                    class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span
                    class="o">*</span><span class="mi">100</span><span class="si">:</span><span
                    class="s2">.2f</span><span class="si">}</span><span class="s2"> %"</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Initial power conversion = 0.06 %
Final power conversion = 76.22 %
</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=209d151d-4fe5-4b5e-8c3b-633c0b451c70">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <p>We then will visualize the final structure, so we convert it to a regular <code>Simulation</code> using the
          final permittivity values and plot it.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=cfde96ed-f4b4-4106-b70e-0659058a82d6">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [18]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_final</span> <span class="o">=</span> <span
                  class="n">make_sim</span><span class="p">(</span><span class="n">params_after</span><span
                  class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=bf4f8d78-4e89-4e07-9104-ea2af902f999">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [19]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data_final</span> <span
                  class="o">=</span> <span class="n">data_history</span><span class="p">[</span><span class="o">-</span><span
                  class="mi">1</span><span class="p">]</span>
<span class="n">sim_final</span> <span class="o">=</span> <span class="n">sim_data_final</span><span
                    class="o">.</span><span class="n">simulation</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f5f94163-4388-49d8-9b7b-199ad5d5d480">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [20]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_final</span> <span class="o">=</span> <span
                  class="n">sim_final</span><span class="o">.</span><span class="n">to_simulation</span><span class="p">()[</span><span
                  class="mi">0</span><span class="p">]</span>
<span class="n">sim_final</span><span class="o">.</span><span class="n">plot_eps</span><span class="p">(</span><span
                    class="n">z</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_5.png" alt="cross section at z=0.01"/>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a6309d9a-01da-46da-96f1-236e86d7aa30">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">
      </div>
      <div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
        <p>Finally, we want to inspect the fields, so we add a field monitor to the <code>Simulation</code> and perform
          one more run to record the field values for plotting.</p>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=0a28c766-f877-4760-a0f5-ba7851d1759a">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [21]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">,</span> <span
                  class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span
                  class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span
                  class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span
                  class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span
                  class="n">figsize</span><span class="o">=</span><span class="p">(</span><span
                  class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sim_data_final</span><span class="o">.</span><span
                    class="n">plot_field</span><span class="p">(</span><span class="s2">"field"</span><span
                    class="p">,</span> <span class="s2">"Ey"</span><span class="p">,</span> <span
                    class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span
                    class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">sim_data_final</span><span class="o">.</span><span
                    class="n">plot_field</span><span class="p">(</span><span class="s2">"field"</span><span
                    class="p">,</span> <span class="s2">"Ey"</span><span class="p">,</span> <span
                    class="s2">"abs^2"</span><span class="p">,</span> <span class="n">z</span><span
                    class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span
                    class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedImage jp-OutputArea-output">
          <img loading="eager" class="" src="/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_6.png" alt="cross section at z=0.00"/>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=459d6a8d-fb97-4f28-bd8a-d74ea017dff2">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [33]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span
                  class="k">as</span> <span class="nn">animation</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span
                    class="n">HTML</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span
                    class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span
                    class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span
                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span
                    class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span
                    class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span
                    class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span
                    class="mi">4</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">i</span><span
                    class="p">):</span>

    <span class="c1"># grab data at iteration "i"</span>
    <span class="n">sim_data_i</span> <span class="o">=</span> <span class="n">data_history</span><span
                    class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># plot permittivity</span>
    <span class="n">sim_i</span> <span class="o">=</span> <span class="n">sim_data_i</span><span class="o">.</span><span
                    class="n">simulation</span><span class="o">.</span><span class="n">to_simulation</span><span
                    class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sim_i</span><span class="o">.</span><span class="n">plot_eps</span><span class="p">(</span><span
                    class="n">z</span><span class="o">=</span><span class="n">lz</span><span class="o">/</span><span
                    class="mi">2</span><span class="p">,</span> <span class="n">monitor_alpha</span><span
                    class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span
                    class="n">source_alpha</span><span class="o">=</span><span class="mf">0.0</span><span
                    class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span
                    class="p">)</span>
    <span class="c1"># ax1.set_aspect('equal')</span>

    <span class="c1"># plot intensity</span>
    <span class="c1"># int_i = sim_data_i.get_intensity("field")</span>
    <span class="c1"># int_i.squeeze().plot.pcolormesh(x='x', y='y', ax=ax2, add_colorbar=True, cmap="magma")</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">sim_data_i</span><span class="p">[</span><span
                    class="s2">"field"</span><span class="p">]</span><span class="o">.</span><span
                    class="n">Ey</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span
                    class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span
                    class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">y</span><span
                    class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">ax</span><span
                    class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span
                    class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span
                    class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span
                    class="s2">"magma"</span><span class="p">)</span>
    <span class="c1"># ax2.set_aspect('equal')</span>

<span class="c1"># create animation</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span
                    class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span
                    class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span
                    class="n">frames</span><span class="o">=</span><span class="nb">len</span><span
                    class="p">(</span><span class="n">data_history</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># display the animation (press "play" to start)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_jshtml</span><span
                    class="p">())</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child jp-OutputArea-executeResult">
        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[33]:</div>
        <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
             data-mime-type="text/html">
          <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet"/>
          <script language="javascript">
            function isInternetExplorer() {
              ua = navigator.userAgent;
              /* MSIE used to detect old browsers and Trident used to newer ones*/
              return ua.indexOf("MSIE ") > -1 || ua.indexOf("Trident/") > -1;
            }

            /* Define the Animation class */
            function Animation(frames, img_id, slider_id, interval, loop_select_id) {
              this.img_id = img_id;
              this.slider_id = slider_id;
              this.loop_select_id = loop_select_id;
              this.interval = interval;
              this.current_frame = 0;
              this.direction = 0;
              this.timer = null;
              this.frames = new Array(frames.length);

              for (var i = 0; i < frames.length; i++) {
                this.frames[i] = new Image();
                this.frames[i].src = frames[i];
              }
              var slider = document.getElementById(this.slider_id);
              slider.max = this.frames.length - 1;
              if (isInternetExplorer()) {
                // switch from oninput to onchange because IE <= 11 does not conform
                // with W3C specification. It ignores oninput and onchange behaves
                // like oninput. In contrast, Microsoft Edge behaves correctly.
                slider.setAttribute('onchange', slider.getAttribute('oninput'));
                slider.setAttribute('oninput', null);
              }
              this.set_frame(this.current_frame);
            }

            Animation.prototype.get_loop_state = function () {
              var button_group = document[this.loop_select_id].state;
              for (var i = 0; i < button_group.length; i++) {
                var button = button_group[i];
                if (button.checked) {
                  return button.value;
                }
              }
              return undefined;
            }

            Animation.prototype.set_frame = function (frame) {
              this.current_frame = frame;
              document.getElementById(this.img_id).src =
                this.frames[this.current_frame].src;
              document.getElementById(this.slider_id).value = this.current_frame;
            }

            Animation.prototype.next_frame = function () {
              this.set_frame(Math.min(this.frames.length - 1, this.current_frame + 1));
            }

            Animation.prototype.previous_frame = function () {
              this.set_frame(Math.max(0, this.current_frame - 1));
            }

            Animation.prototype.first_frame = function () {
              this.set_frame(0);
            }

            Animation.prototype.last_frame = function () {
              this.set_frame(this.frames.length - 1);
            }

            Animation.prototype.slower = function () {
              this.interval /= 0.7;
              if (this.direction > 0) {
                this.play_animation();
              } else if (this.direction < 0) {
                this.reverse_animation();
              }
            }

            Animation.prototype.faster = function () {
              this.interval *= 0.7;
              if (this.direction > 0) {
                this.play_animation();
              } else if (this.direction < 0) {
                this.reverse_animation();
              }
            }

            Animation.prototype.anim_step_forward = function () {
              this.current_frame += 1;
              if (this.current_frame < this.frames.length) {
                this.set_frame(this.current_frame);
              } else {
                var loop_state = this.get_loop_state();
                if (loop_state == "loop") {
                  this.first_frame();
                } else if (loop_state == "reflect") {
                  this.last_frame();
                  this.reverse_animation();
                } else {
                  this.pause_animation();
                  this.last_frame();
                }
              }
            }

            Animation.prototype.anim_step_reverse = function () {
              this.current_frame -= 1;
              if (this.current_frame >= 0) {
                this.set_frame(this.current_frame);
              } else {
                var loop_state = this.get_loop_state();
                if (loop_state == "loop") {
                  this.last_frame();
                } else if (loop_state == "reflect") {
                  this.first_frame();
                  this.play_animation();
                } else {
                  this.pause_animation();
                  this.first_frame();
                }
              }
            }

            Animation.prototype.pause_animation = function () {
              this.direction = 0;
              if (this.timer) {
                clearInterval(this.timer);
                this.timer = null;
              }
            }

            Animation.prototype.play_animation = function () {
              this.pause_animation();
              this.direction = 1;
              var t = this;
              if (!this.timer) this.timer = setInterval(function () {
                t.anim_step_forward();
              }, this.interval);
            }

            Animation.prototype.reverse_animation = function () {
              this.pause_animation();
              this.direction = -1;
              var t = this;
              if (!this.timer) this.timer = setInterval(function () {
                t.anim_step_reverse();
              }, this.interval);
            }
          </script>
          <style>
              .animation {
                  display: inline-block;
                  text-align: center;
              }

              input[type=range].anim-slider {
                  width: 374px;
                  margin-left: auto;
                  margin-right: auto;
              }

              .anim-buttons {
                  margin: 8px 0px;
              }

              .anim-buttons button {
                  padding: 0;
                  width: 36px;
              }

              .anim-state label {
                  margin-right: 8px;
              }

              .anim-state input {
                  margin: 0;
                  vertical-align: middle;
              }
          </style>
          <div class="animation">
            <img id="_anim_img93119e7b79634a53ae8911d843a4bd96"/>
            <div class="anim-controls">
              <input class="anim-slider" id="_anim_slider93119e7b79634a53ae8911d843a4bd96" max="1" min="0" name="points"
                     oninput="anim93119e7b79634a53ae8911d843a4bd96.set_frame(parseInt(this.value));" step="1"
                     type="range" value="0"/>
              <div class="anim-buttons">
                <button aria-label="Decrease speed" onclick="anim93119e7b79634a53ae8911d843a4bd96.slower()"
                        title="Decrease speed">
                  <i class="fa fa-minus"></i></button>
                <button aria-label="First frame" onclick="anim93119e7b79634a53ae8911d843a4bd96.first_frame()"
                        title="First frame">
                  <i class="fa fa-fast-backward"></i></button>
                <button aria-label="Previous frame" onclick="anim93119e7b79634a53ae8911d843a4bd96.previous_frame()"
                        title="Previous frame">
                  <i class="fa fa-step-backward"></i></button>
                <button aria-label="Play backwards" onclick="anim93119e7b79634a53ae8911d843a4bd96.reverse_animation()"
                        title="Play backwards">
                  <i class="fa fa-play fa-flip-horizontal"></i></button>
                <button aria-label="Pause" onclick="anim93119e7b79634a53ae8911d843a4bd96.pause_animation()"
                        title="Pause">
                  <i class="fa fa-pause"></i></button>
                <button aria-label="Play" onclick="anim93119e7b79634a53ae8911d843a4bd96.play_animation()" title="Play">
                  <i class="fa fa-play"></i></button>
                <button aria-label="Next frame" onclick="anim93119e7b79634a53ae8911d843a4bd96.next_frame()"
                        title="Next frame">
                  <i class="fa fa-step-forward"></i></button>
                <button aria-label="Last frame" onclick="anim93119e7b79634a53ae8911d843a4bd96.last_frame()"
                        title="Last frame">
                  <i class="fa fa-fast-forward"></i></button>
                <button aria-label="Increase speed" onclick="anim93119e7b79634a53ae8911d843a4bd96.faster()"
                        title="Increase speed">
                  <i class="fa fa-plus"></i></button>
              </div>
              <form action="#n" aria-label="Repetition mode" class="anim-state"
                    name="_anim_loop_select93119e7b79634a53ae8911d843a4bd96" title="Repetition mode">
                <input id="_anim_radio1_93119e7b79634a53ae8911d843a4bd96" name="state" type="radio" value="once"/>
                <label for="_anim_radio1_93119e7b79634a53ae8911d843a4bd96">Once</label>
                <input checked="" id="_anim_radio2_93119e7b79634a53ae8911d843a4bd96" name="state" type="radio"
                       value="loop"/>
                <label for="_anim_radio2_93119e7b79634a53ae8911d843a4bd96">Loop</label>
                <input id="_anim_radio3_93119e7b79634a53ae8911d843a4bd96" name="state" type="radio" value="reflect"/>
                <label for="_anim_radio3_93119e7b79634a53ae8911d843a4bd96">Reflect</label>
              </form>
            </div>
          </div>
          <script language="javascript">
            /* Instantiate the Animation class. */
            /* The IDs given should match those used in the template above. */
            (function () {
              var img_id = "_anim_img93119e7b79634a53ae8911d843a4bd96";
              var slider_id = "_anim_slider93119e7b79634a53ae8911d843a4bd96";
              var loop_select_id = "_anim_loop_select93119e7b79634a53ae8911d843a4bd96";
              var frames = new Array(51);

              frames[0] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_1.png"
              frames[1] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_2.png"
              frames[2] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_3.png"
              frames[3] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_4.png"
              frames[4] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_5.png"
              frames[5] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_6.png"
              frames[6] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_7.png"
              frames[7] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_8.png"
              frames[8] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_9.png"
              frames[9] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_10.png"
              frames[10] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_11.png"
              frames[11] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_12.png"
              frames[12] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_13.png"
              frames[13] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_14.png"
              frames[14] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_15.png"
              frames[15] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_16.png"
              frames[16] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_17.png"
              frames[17] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_18.png"
              frames[18] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_19.png"
              frames[19] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_20.png"
              frames[20] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_21.png"
              frames[21] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_22.png"
              frames[22] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_23.png"
              frames[23] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_24.png"
              frames[24] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_25.png"
              frames[25] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_26.png"
              frames[26] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_27.png"
              frames[27] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_28.png"
              frames[28] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_29.png"
              frames[29] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_30.png"
              frames[30] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_31.png"
              frames[31] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_32.png"
              frames[32] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_33.png"
              frames[33] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_34.png"
              frames[34] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_35.png"
              frames[35] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_36.png"
              frames[36] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_37.png"
              frames[37] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_38.png"
              frames[38] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_39.png"
              frames[39] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_40.png"
              frames[40] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_41.png"
              frames[41] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_42.png"
              frames[42] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_43.png"
              frames[43] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_44.png"
              frames[44] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_45.png"
              frames[45] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_46.png"
              frames[46] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_47.png"
              frames[47] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_48.png"
              frames[48] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_49.png"
              frames[49] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_50.png"
              frames[50] = "/assets/images/inverse-design/Lecture_04/Python_Tutorial_04_extra_51.png"


              /* set a timeout to make sure all the above elements are created before
                 the object is initialized. */
              setTimeout(function () {
                anim93119e7b79634a53ae8911d843a4bd96 = new Animation(frames, img_id, slider_id, 200.0,
                  loop_select_id);
              }, 0);
            })()
          </script>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>&lt;Figure size 640x480 with 0 Axes&gt;</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1dcfe8b3-4b09-40ea-8552-37e05b5426d4">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [34]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span><span class="n">ani</span><span class="o">.</span><span
                  class="n">save</span><span class="p">(</span><span class="s1">'animation_best.gif'</span><span
                  class="p">,</span> <span class="n">writer</span><span class="o">=</span><span
                  class="s1">'imagemagick'</span><span class="p">,</span> <span class="n">fps</span><span
                  class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="jp-Cell-outputWrapper">
    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
    </div>
    <div class="jp-OutputArea jp-Cell-outputArea">
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
<pre>MovieWriter imagemagick unavailable; using Pillow instead.
</pre>
        </div>
      </div>
      <div class="jp-OutputArea-child">
        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>&lt;Figure size 640x480 with 0 Axes&gt;</pre>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=ba69fbe7-9915-4872-b1cc-4ba60e3fa40a">
  <div class="jp-Cell-inputWrapper">
    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
    </div>
    <div class="jp-InputArea jp-Cell-inputArea">
      <div class="jp-InputPrompt jp-InputArea-prompt">In [ ]:</div>
      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
          <div class="highlight hl-ipython3"><pre><span></span>
</pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
<script type="application/vnd.jupyter.widget-state+json">
  {"state": {"02bd58b8f27b49079c8cfaae08e484ed": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0cc59d91e6884de8878637d06f69298f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "131b81dce4714ce69a7ed086788d1178": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_346b3ff743f84696a2a3eb47172865a6", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\"&gt;\u2191&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;simulation.hdf5.gz&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;43.0/43.0 kB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;31m\u2191\u001b[0m \u001b[1;34msimulation.hdf5.gz\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m43.0/43.0 kB\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "1c3c5d9b9f8c4762af46440e2f9de9b0": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0cc59d91e6884de8878637d06f69298f", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83d\udeb6 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Starting 'inv_des'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83d\udeb6 \u001b[0m \u001b[1;32mStarting 'inv_des'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "28d2d187d50744619ffd15c7ae3d46ab": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2cf4637d47444cb89788003100a96e1c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2d8b8f7952de4429a454df590618cd63": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_97b116cecc8d4eba90ff6f1899098767", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\"&gt;\u2191&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;jax_info.json&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;174/174 bytes&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;31m\u2191\u001b[0m \u001b[1;34mjax_info.json\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m174/174 bytes\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "346b3ff743f84696a2a3eb47172865a6": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3b97302e734846f68dc34be2e1e9f622": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_477714e92f7845838dcca8908b862048", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83c\udfc3 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Finishing 'inv_des_final'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83c\udfc3 \u001b[0m \u001b[1;32mFinishing 'inv_des_final'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "3f3ecee4ff984da1ab6af8cde74aa4d6": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2cf4637d47444cb89788003100a96e1c", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;\u2193&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;monitor_data.hdf5&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;148.6/148.6 kB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;32m\u2193\u001b[0m \u001b[1;34mmonitor_data.hdf5\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m148.6/148.6 kB\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "43ee1faf5c0f4bd7952b4c9f3901f58d": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_28d2d187d50744619ffd15c7ae3d46ab", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83c\udfc3 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Finishing 'inv_des_adj'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83c\udfc3 \u001b[0m \u001b[1;32mFinishing 'inv_des_adj'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "477714e92f7845838dcca8908b862048": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d65e6b885674bc8bff06e62f0b089f6": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a1c5f0dfa271458dad9e5ded066f966f", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83c\udfc3 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Finishing 'inv_des'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83c\udfc3 \u001b[0m \u001b[1;32mFinishing 'inv_des'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "51efd5e7d641461d9392377e4dc80027": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5bb49f9b044f49518c9c2c21dffed65b": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_02bd58b8f27b49079c8cfaae08e484ed", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;solver progress (field decay = 0.00e+00) &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100%&lt;/span&gt; &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "solver progress (field decay = 0.00e+00) \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "616294d7d1c243feb07bfcc5ab642cc5": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6f6853ea5883400bbff752f3c60139c9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6fe1bfb2d1a14e339a1b711d8b1d89a1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "706c91a16eb347379d86f710b83d7e6b": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8078dc74436c47b093bd481bb6624578", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;\u2193&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;jax_sim_vjp.hdf5&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;237.1/237.1 kB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;32m\u2193\u001b[0m \u001b[1;34mjax_sim_vjp.hdf5\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m237.1/237.1 kB\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "7417aa6cc0bb4350b3f28e1826298b03": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "756ecdb25ec94e52907adfd2ecb443f3": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f52a00c4ea904dccb1418ba1a118d6be", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83d\udeb6 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Starting 'inv_des_adj'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83d\udeb6 \u001b[0m \u001b[1;32mStarting 'inv_des_adj'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "8078dc74436c47b093bd481bb6624578": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8a006d803a9341ba81fc1cddec63f4cf": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d61f53cb0349458ab366bebcc42a6028", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\"&gt;\u2191&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;simulation.hdf5.gz&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;110.6/110.6 kB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;31m\u2191\u001b[0m \u001b[1;34msimulation.hdf5.gz\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m110.6/110.6 kB\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "97916d3681e24426a9724844691f7038": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_7417aa6cc0bb4350b3f28e1826298b03", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;\ud83d\udeb6 &lt;/span&gt; &lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;Starting 'inv_des_final'...&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[32m\ud83d\udeb6 \u001b[0m \u001b[1;32mStarting 'inv_des_final'...\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "97b116cecc8d4eba90ff6f1899098767": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9ac6fa173f624d24a2fce05e6f1327d0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a1c5f0dfa271458dad9e5ded066f966f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a992634b68574d25a4c65061ebdad55f": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6fe1bfb2d1a14e339a1b711d8b1d89a1", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\"&gt;\u2193&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;monitor_data.hdf5&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;13.3/13.3 MB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;22.4 MB/s&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;32m\u2193\u001b[0m \u001b[1;34mmonitor_data.hdf5\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m13.3/13.3 MB\u001b[0m \u2022 \u001b[31m22.4 MB/s\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "b17032aa2dca423080814069bd0548cb": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9ac6fa173f624d24a2fce05e6f1327d0", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\"&gt;\u2191&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;simulation.hdf5.gz&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;100.1/100.1 kB&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;31m\u2191\u001b[0m \u001b[1;34msimulation.hdf5.gz\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m100.1/100.1 kB\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "d61f53cb0349458ab366bebcc42a6028": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e84d3af0debd414ba94b938d3a285d75": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6f6853ea5883400bbff752f3c60139c9", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;solver progress (field decay = 0.00e+00) &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100%&lt;/span&gt; &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "solver progress (field decay = 0.00e+00) \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "f2fb4fc3f8be4eb7acfb42679d70a73c": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_51efd5e7d641461d9392377e4dc80027", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;&lt;span style=\"color: #800000; text-decoration-color: #800000; font-weight: bold\"&gt;\u2191&lt;/span&gt; &lt;span style=\"color: #000080; text-decoration-color: #000080; font-weight: bold\"&gt;jax_info.json&lt;/span&gt; &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100.0%&lt;/span&gt; \u2022 &lt;span style=\"color: #008000; text-decoration-color: #008000\"&gt;174/174 bytes&lt;/span&gt; \u2022 &lt;span style=\"color: #800000; text-decoration-color: #800000\"&gt;?&lt;/span&gt; \u2022 &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "\u001b[1;31m\u2191\u001b[0m \u001b[1;34mjax_info.json\u001b[0m \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100.0%\u001b[0m \u2022 \u001b[32m174/174 bytes\u001b[0m \u2022 \u001b[31m?\u001b[0m \u2022 \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "f3e34e693eff477797f8c8517fbf1a82": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_616294d7d1c243feb07bfcc5ab642cc5", "msg_id": "", "outputs": [{"data": {"text/html": "&lt;pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"&gt;solver progress (field decay = 0.00e+00) &lt;span style=\"color: #729c1f; text-decoration-color: #729c1f\"&gt;\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501&lt;/span&gt; &lt;span style=\"color: #800080; text-decoration-color: #800080\"&gt;100%&lt;/span&gt; &lt;span style=\"color: #008080; text-decoration-color: #008080\"&gt;0:00:00&lt;/span&gt;\n&lt;/pre&gt;\n", "text/plain": "solver progress (field decay = 0.00e+00) \u001b[38;2;114;156;31m\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u001b[0m \u001b[35m100%\u001b[0m \u001b[36m0:00:00\u001b[0m\n"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "f52a00c4ea904dccb1418ba1a118d6be": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}
</script>
</html>
