---
author: Tom Chen
custom_css:
- learning-center/fdtd101
- learning-center/menu
- learning-center/home
custom_font: font2
description: This notebook demonstrates advanced xarray features for postprocessing
  and visualization.
layout: learning-center/example-library
menu_config:
  collapsed: true
  selected: Tidy3D Python
metadata:
  category: Data Visualization and Postprocessing
  enable_more_examples: false
  more_examples:
  - name: Performing visualization of simulation data
    path: notebooks/VizData/
  - name: Creating FDTD animations
    path: notebooks/AnimationTutorial/
  - name: Performing near field to far field projections
    path: notebooks/FieldProjections/
  pagination:
    next:
      name: Creating FDTD animations
      path: notebooks/AnimationTutorial/
    previous:
      name: Performing visualization of simulation data
      path: notebooks/VizData/
  type: python-tutorial
page_title: Advanced monitor data manipulation and visualization
source_link: https:/docs.flexcompute.com/projects/tidy3d/en/latest/_sources/notebooks/XarrayTutorial.ipynb
tags:
- xarray
- postprocessing
- visualization
- Tidy3D
- FDTD
title: Advanced monitor data manipulation and visualization | Flexcompute
---


<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="/assets/tidy3d/examples/css/example-notebook.css" rel="stylesheet"/>





<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>

<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      maxEdges: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        let { svg } = await mermaid.render(id, raw, el);
        svg = cleanMermaidSvg(svg);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }


    /**
     * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
     */
    function cleanMermaidSvg(svg) {
      return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
    }


    /**
     * A regular expression for all void elements, which may include attributes and
     * a slash.
     *
     * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
     *
     * Of these, only `<br>` is generated by Mermaid in place of `\n`,
     * but _any_ "malformed" tag will break the SVG rendering entirely.
     */
    const RE_VOID_ELEMENT =
      /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

    /**
     * Ensure a void element is closed with a slash, preserving any attributes.
     */
    function replaceVoidElement(match, tag, rest) {
      rest = rest.trim();
      if (!rest.endsWith('/')) {
        rest = `${rest} /`;
      }
      return `<${tag} ${rest}>`;
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>

</head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=e14808f9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ca1802c8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In the previous <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/VizData/" target="_blank">tutorial</a>, we have demonstrated the basics of data manipulation and visualization. As discussed, in <code>Tidy3D</code>, we represent multi-dimensional data (such as arrays) using <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" target="_blank">xarray.DataArray</a> objects. It's important to note that the <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" target="_blank">xarray</a> package provides a lot of functionalities that can greatly simplify our data postprocessing and visualization when used appropriately.</p>
<p>In this tutorial, we will first briefly review some basic <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" target="_blank">xarray</a> features and then delve into some advanced features such as performing interpolation and integration. This tutorial is designed for users who are already familiar with <code>Tidy3D</code>'s basic workflow and would like to learn more about data manipulation and visualization. If you are very new to <code>Tidy3D</code>, we suggest checking out the <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/StartHere/" target="_blank">quick start</a>, the <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/Simulation/" target="_blank">first walkthrough</a>, and the <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/Primer/" target="_blank">working principles</a> tutorials first.</p>
<p>It's important to note that the <code>xarray</code> library contains many more functionalities that are not demonstrated here. We encourage users to reference the <a href="https://docs.xarray.dev/en/stable/api.html" target="_blank">documentation</a> to see what is possible. We also recommend users to watch the <a href="https://www.youtube.com/watch?v=mecN-Ph_-78" target="_blank">introduction video</a> on <code>xarray</code> if you would like to learn more about it. After overcoming the initial learning curve, our users all find data manipulation with <code>xarray</code> to be extremely flexible and efficient.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=7149f697">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">tidy3d</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">from</span> <span class="nn">tidy3d</span> <span class="kn">import</span> <span class="n">web</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=0d12583d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Load-Simulation-Data">Load Simulation Data<a class="anchor-link" href="#Load-Simulation-Data">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=680ca396">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Since this tutorial is focused on data analysis, we will skip the simulation setup part and only load the simulation result from a previously obtained hdf5 file. We load the hdf5 file to a variable <code>sim_data</code> using the <code>from_hdf5</code> method of <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.SimulationData.html" target="_blank">SimulationData</a>. This is completely analogous to the situation where you just finished running a simulation.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=b0765258">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">SimulationData</span><span class="o">.</span><span class="n">from_hdf5</span><span class="p">(</span><span class="s2">"misc/mmi_simulation_data.h5"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=02d2e79e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The loaded data contains two parts: <code>simulation</code> and <code>monitor_data</code>. <code>simulation</code> is simply the original <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.Simulation.html" target="_blank">Simulation</a>. We can use it to visualize the simulation in 3D for example.</p>
<p>As we can see, this simulation contains a 1 by 2 MMI power splitter.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=71c5e809">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">plot_3d</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output" data-mime-type="text/html" tabindex="0">
<iframe allowfullscreen="true" height="800" id="simulation-viewer170241030514924544" src="https://feature-simulation-viewer.d3a9gfg7glllfq.amplifyapp.com/simulation-viewer?uuid=170241030514924544" width="800"></iframe>
<script>
        
    window.postMessageToViewer170241030514924544 = event => {
        if(event.data.type === 'viewer'&&event.data.uuid==='170241030514924544'){
            document.getElementById('simulation-viewer170241030514924544').contentWindow.postMessage({ type: 'jupyter', uuid:'170241030514924544', value:{
    "type": "Simulation",
    "center": [
        0.0,
        0.0,
        0.0
    ],
    "size": [
        55.6,
        5.925000000000001,
        2.08
    ],
    "run_time": 3e-12,
    "medium": {
        "name": "SiO2",
        "frequency_range": null,
        "allow_gain": false,
        "nonlinear_spec": null,
        "type": "Medium",
        "permittivity": 2.1315999999999997,
        "conductivity": 0.0
    },
    "symmetry": [
        0,
        0,
        0
    ],
    "structures": [
        {
            "geometry": {
                "type": "Box",
                "center": [
                    0.0,
                    0.0,
                    0.0
                ],
                "size": [
                    11.5,
                    3.6,
                    0.22
                ]
            },
            "name": "MMI section",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "PolySlab",
                "axis": 2,
                "sidewall_angle": 0.0,
                "reference_plane": "middle",
                "slab_bounds": [
                    -0.11,
                    0.11
                ],
                "dilation": 0.0,
                "vertices": [
                    [
                        -25.8,
                        0.25
                    ],
                    [
                        -5.75,
                        0.6
                    ],
                    [
                        -5.75,
                        -0.6
                    ],
                    [
                        -25.8,
                        -0.25
                    ]
                ]
            },
            "name": "Input taper",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "PolySlab",
                "axis": 2,
                "sidewall_angle": 0.0,
                "reference_plane": "middle",
                "slab_bounds": [
                    -0.11,
                    0.11
                ],
                "dilation": 0.0,
                "vertices": [
                    [
                        5.75,
                        0.3
                    ],
                    [
                        5.75,
                        1.5
                    ],
                    [
                        25.8,
                        1.15
                    ],
                    [
                        25.8,
                        0.6499999999999999
                    ]
                ]
            },
            "name": "Output taper (top)",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "PolySlab",
                "axis": 2,
                "sidewall_angle": 0.0,
                "reference_plane": "middle",
                "slab_bounds": [
                    -0.11,
                    0.11
                ],
                "dilation": 0.0,
                "vertices": [
                    [
                        5.75,
                        -0.3
                    ],
                    [
                        5.75,
                        -1.5
                    ],
                    [
                        25.8,
                        -1.15
                    ],
                    [
                        25.8,
                        -0.6499999999999999
                    ]
                ]
            },
            "name": "Output taper (bottom)",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "Box",
                "center": [
                    -32.9,
                    0.0,
                    0.0
                ],
                "size": [
                    14.2,
                    0.5,
                    0.22
                ]
            },
            "name": "Input straight waveguide",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "Box",
                "center": [
                    32.9,
                    0.8999999999999999,
                    0.0
                ],
                "size": [
                    14.200000000000003,
                    0.5,
                    0.22
                ]
            },
            "name": "Output straight waveguide (top)",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        },
        {
            "geometry": {
                "type": "Box",
                "center": [
                    32.9,
                    -0.8999999999999999,
                    0.0
                ],
                "size": [
                    14.200000000000003,
                    0.5,
                    0.22
                ]
            },
            "name": "Output straight waveguide (bottom)",
            "type": "Structure",
            "medium": {
                "name": "Si",
                "frequency_range": null,
                "allow_gain": false,
                "nonlinear_spec": null,
                "type": "Medium",
                "permittivity": 12.1104,
                "conductivity": 0.0
            }
        }
    ],
    "sources": [
        {
            "type": "ModeSource",
            "center": [
                -26.8,
                0.0,
                0.0
            ],
            "size": [
                0.0,
                1.5,
                0.88
            ],
            "source_time": {
                "amplitude": 1.0,
                "phase": 0.0,
                "type": "GaussianPulse",
                "freq0": 193414489032258.06,
                "fwidth": 6245676208333.328,
                "offset": 5.0,
                "remove_dc_component": true
            },
            "name": "Mode source",
            "num_freqs": 1,
            "direction": "+",
            "mode_spec": {
                "num_modes": 1,
                "target_neff": 3.48,
                "num_pml": [
                    0,
                    0
                ],
                "filter_pol": null,
                "angle_theta": 0.0,
                "angle_phi": 0.0,
                "precision": "single",
                "bend_radius": null,
                "bend_axis": null,
                "track_freq": "central",
                "group_index_step": false,
                "type": "ModeSpec"
            },
            "mode_index": 0
        }
    ],
    "boundary_spec": {
        "x": {
            "plus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "minus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "type": "Boundary"
        },
        "y": {
            "plus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "minus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "type": "Boundary"
        },
        "z": {
            "plus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "minus": {
                "name": null,
                "type": "PML",
                "num_layers": 12,
                "parameters": {
                    "sigma_order": 3,
                    "sigma_min": 0.0,
                    "sigma_max": 1.5,
                    "type": "PMLParams",
                    "kappa_order": 3,
                    "kappa_min": 1.0,
                    "kappa_max": 3.0,
                    "alpha_order": 1,
                    "alpha_min": 0.0,
                    "alpha_max": 0.0
                }
            },
            "type": "Boundary"
        },
        "type": "BoundarySpec"
    },
    "monitors": [
        {
            "type": "FluxMonitor",
            "center": [
                26.8,
                0.8999999999999999,
                0.0
            ],
            "size": [
                0.0,
                1.5,
                0.88
            ],
            "name": "Flux monitor",
            "interval_space": [
                1,
                1,
                1
            ],
            "colocate": true,
            "freqs": [
                199861643525342.56,
                199590092379248.34,
                199319278142641.5,
                199049197819955.0,
                198779848431835.97,
                198511227015036.2,
                198243330622303.34,
                197976156322273.28,
                197709701199363.1,
                197443962353665.03,
                197178936900841.3,
                196914621972019.8,
                196651014713690.44,
                196388112287602.62,
                196125911870663.25,
                195864410654835.7,
                195603605847039.62,
                195343494669051.53,
                195084074357406.06,
                194825342163298.1,
                194567295352485.75,
                194309931205194.12,
                194053247016019.47,
                193797240093834.75,
                193541907761695.3,
                193287247356745.72,
                193033256230127.12,
                192779931746885.47,
                192527271285880.38,
                192275272239694.7,
                192023932014544.75,
                191773248030191.56,
                191523217719852.3,
                191273838530112.9,
                191025107920841.0,
                190777023365099.62,
                190529582349061.88,
                190282782371925.78,
                190036620945830.16,
                189791095595770.94,
                189546203859518.34,
                189301943287534.4,
                189058311442891.5,
                188815305901191.12,
                188572924250483.56,
                188331164091188.06,
                188090023036013.7,
                187849498709880.7,
                187609588749842.53,
                187370290805008.84
            ],
            "apodization": {
                "start": null,
                "end": null,
                "width": null,
                "type": "ApodizationSpec"
            },
            "normal_dir": "+",
            "exclude_surfaces": null
        },
        {
            "type": "ModeMonitor",
            "center": [
                26.8,
                0.8999999999999999,
                0.0
            ],
            "size": [
                0.0,
                1.5,
                0.88
            ],
            "name": "Mode monitor",
            "interval_space": [
                1,
                1,
                1
            ],
            "colocate": false,
            "freqs": [
                199861643525342.56,
                199590092379248.34,
                199319278142641.5,
                199049197819955.0,
                198779848431835.97,
                198511227015036.2,
                198243330622303.34,
                197976156322273.28,
                197709701199363.1,
                197443962353665.03,
                197178936900841.3,
                196914621972019.8,
                196651014713690.44,
                196388112287602.62,
                196125911870663.25,
                195864410654835.7,
                195603605847039.62,
                195343494669051.53,
                195084074357406.06,
                194825342163298.1,
                194567295352485.75,
                194309931205194.12,
                194053247016019.47,
                193797240093834.75,
                193541907761695.3,
                193287247356745.72,
                193033256230127.12,
                192779931746885.47,
                192527271285880.38,
                192275272239694.7,
                192023932014544.75,
                191773248030191.56,
                191523217719852.3,
                191273838530112.9,
                191025107920841.0,
                190777023365099.62,
                190529582349061.88,
                190282782371925.78,
                190036620945830.16,
                189791095595770.94,
                189546203859518.34,
                189301943287534.4,
                189058311442891.5,
                188815305901191.12,
                188572924250483.56,
                188331164091188.06,
                188090023036013.7,
                187849498709880.7,
                187609588749842.53,
                187370290805008.84
            ],
            "apodization": {
                "start": null,
                "end": null,
                "width": null,
                "type": "ApodizationSpec"
            },
            "mode_spec": {
                "num_modes": 3,
                "target_neff": 3.48,
                "num_pml": [
                    0,
                    0
                ],
                "filter_pol": null,
                "angle_theta": 0.0,
                "angle_phi": 0.0,
                "precision": "single",
                "bend_radius": null,
                "bend_axis": null,
                "track_freq": "central",
                "group_index_step": false,
                "type": "ModeSpec"
            }
        },
        {
            "type": "FieldMonitor",
            "center": [
                0.0,
                0.0,
                0.0
            ],
            "size": [
                "Infinity",
                "Infinity",
                0.2
            ],
            "name": "Field monitor",
            "interval_space": [
                2,
                2,
                2
            ],
            "colocate": true,
            "freqs": [
                199861643525342.66,
                193414493734202.56,
                187370290805008.75
            ],
            "apodization": {
                "start": null,
                "end": null,
                "width": null,
                "type": "ApodizationSpec"
            },
            "fields": [
                "Hz"
            ]
        }
    ],
    "grid_spec": {
        "grid_x": {
            "type": "AutoGrid",
            "min_steps_per_wvl": 10.0,
            "max_scale": 1.4,
            "dl_min": 0.0,
            "mesher": {
                "type": "GradedMesher"
            }
        },
        "grid_y": {
            "type": "AutoGrid",
            "min_steps_per_wvl": 10.0,
            "max_scale": 1.4,
            "dl_min": 0.0,
            "mesher": {
                "type": "GradedMesher"
            }
        },
        "grid_z": {
            "type": "AutoGrid",
            "min_steps_per_wvl": 10.0,
            "max_scale": 1.4,
            "dl_min": 0.0,
            "mesher": {
                "type": "GradedMesher"
            }
        },
        "wavelength": 1.55,
        "override_structures": [],
        "type": "GridSpec"
    },
    "shutoff": 1e-05,
    "subpixel": true,
    "normalize_index": 0,
    "courant": 0.99,
    "version": "2.4.3"
}}, '*')
        }
    };
    window.addEventListener(
        'message',
        window.postMessageToViewer170241030514924544,
        false
    );
    
    </script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5a1bb03d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><code>monitor_data</code>, as the name suggests, contains data from all monitors defined in the simulation. <code>monitor_data</code> is a dictionary with the keys being the names of the monitors. Let's print out the keys to see what they are.</p>
<p>Here we have three monitors named <code>Flux monitor</code>, <code>Mode monitor</code>, and <code>Field monitor</code>. In the following sections, we will examine them individually and use them to demonstrate various functionalities of <code>xarray</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2aa84094">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="o">.</span><span class="n">monitor_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[4]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>dict_keys(['Flux monitor', 'Mode monitor', 'Field monitor'])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=46a28aac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="FluxMonitor-Data">FluxMonitor Data<a class="anchor-link" href="#FluxMonitor-Data">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=abb9b468">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We can access the data for each monitor by indexing into the <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.SimulationData.html" target="_blank">SimulationData</a> with the monitor <code>.name</code>. The monitor dataset contains one or more <code>xarray.DataArray</code> objects storing the actual raw data. For the flux monitor data, we can access the raw flux data as a function of frequency with <code>.flux</code>. As most data are multidimensional, it's often very helpful to print out the data and directly inspect its structure.</p>
<p>Here we can see that the flux is an array with only one coordinate <code>f</code>, which is frequency in Hz. The unit of flux is W.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=b380ec35">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[5]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.FluxDataArray (f: 50)&gt;
array([0.49619535, 0.4959998 , 0.4958456 , 0.49578664, 0.4958678 ,
       0.49604478, 0.49626908, 0.49647027, 0.4966077 , 0.49661922,
       0.49642277, 0.49594647, 0.4951819 , 0.4942104 , 0.4932421 ,
       0.4924945 , 0.4921227 , 0.49211392, 0.49230942, 0.4924388 ,
       0.49224442, 0.49157965, 0.4904679 , 0.48906133, 0.4876103 ,
       0.48636082, 0.4854779 , 0.4849979 , 0.48482403, 0.48475057,
       0.48453504, 0.48398182, 0.48302355, 0.48175392, 0.48037806,
       0.47914445, 0.47820777, 0.47757253, 0.47708204, 0.47651216,
       0.47562975, 0.47437435, 0.4728097 , 0.47111368, 0.4695425 ,
       0.46828848, 0.4674291 , 0.4669524 , 0.46673352, 0.46655577],
      dtype=float32)
Coordinates:
  * f        (f) float64 1.999e+14 1.996e+14 1.993e+14 ... 1.876e+14 1.874e+14
Attributes:
    units:      W
    long_name:  flux</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.FluxDataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">f</span>: 50</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input checked="" class="xr-array-in" id="section-8edffed0-e829-4e11-bd1b-771e8b56c4b9" type="checkbox"/><label for="section-8edffed0-e829-4e11-bd1b-771e8b56c4b9" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0.4962 0.496 0.4958 0.4958 0.4959 ... 0.4674 0.467 0.4667 0.4666</span></div><div class="xr-array-data"><pre>array([0.49619535, 0.4959998 , 0.4958456 , 0.49578664, 0.4958678 ,
       0.49604478, 0.49626908, 0.49647027, 0.4966077 , 0.49661922,
       0.49642277, 0.49594647, 0.4951819 , 0.4942104 , 0.4932421 ,
       0.4924945 , 0.4921227 , 0.49211392, 0.49230942, 0.4924388 ,
       0.49224442, 0.49157965, 0.4904679 , 0.48906133, 0.4876103 ,
       0.48636082, 0.4854779 , 0.4849979 , 0.48482403, 0.48475057,
       0.48453504, 0.48398182, 0.48302355, 0.48175392, 0.48037806,
       0.47914445, 0.47820777, 0.47757253, 0.47708204, 0.47651216,
       0.47562975, 0.47437435, 0.4728097 , 0.47111368, 0.4695425 ,
       0.46828848, 0.4674291 , 0.4669524 , 0.46673352, 0.46655577],
      dtype=float32)</pre></div></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-7f20c3e4-1e50-4e6c-9c16-9913157c6a5c" type="checkbox"/><label class="xr-section-summary" for="section-7f20c3e4-1e50-4e6c-9c16-9913157c6a5c">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">f</span></div><div class="xr-var-dims">(f)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.999e+14 1.996e+14 ... 1.874e+14</div><input class="xr-var-attrs-in" id="attrs-e6e40c5d-d23d-495d-81aa-a286f30e2516" type="checkbox"/><label for="attrs-e6e40c5d-d23d-495d-81aa-a286f30e2516" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-7969c9a4-af5d-4314-8f7f-d9b0eca87306" type="checkbox"/><label for="data-7969c9a4-af5d-4314-8f7f-d9b0eca87306" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>Hz</dd><dt><span>long_name :</span></dt><dd>frequency</dd></dl></div><div class="xr-var-data"><pre>array([1.998616e+14, 1.995901e+14, 1.993193e+14, 1.990492e+14, 1.987798e+14,
       1.985112e+14, 1.982433e+14, 1.979762e+14, 1.977097e+14, 1.974440e+14,
       1.971789e+14, 1.969146e+14, 1.966510e+14, 1.963881e+14, 1.961259e+14,
       1.958644e+14, 1.956036e+14, 1.953435e+14, 1.950841e+14, 1.948253e+14,
       1.945673e+14, 1.943099e+14, 1.940532e+14, 1.937972e+14, 1.935419e+14,
       1.932872e+14, 1.930333e+14, 1.927799e+14, 1.925273e+14, 1.922753e+14,
       1.920239e+14, 1.917732e+14, 1.915232e+14, 1.912738e+14, 1.910251e+14,
       1.907770e+14, 1.905296e+14, 1.902828e+14, 1.900366e+14, 1.897911e+14,
       1.895462e+14, 1.893019e+14, 1.890583e+14, 1.888153e+14, 1.885729e+14,
       1.883312e+14, 1.880900e+14, 1.878495e+14, 1.876096e+14, 1.873703e+14])</pre></div></li></ul></div></li><li class="xr-section-item"><input class="xr-section-summary-in" id="section-308d6a9f-7626-40cd-a319-4f49309bd8dd" type="checkbox"/><label class="xr-section-summary" for="section-308d6a9f-7626-40cd-a319-4f49309bd8dd">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>f</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-c3bb29c1-9c30-4746-92bc-cb3c514fc6c4" type="checkbox"/><label for="index-c3bb29c1-9c30-4746-92bc-cb3c514fc6c4" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([199861643525342.56, 199590092379248.34,  199319278142641.5,
        199049197819955.0, 198779848431835.97,  198511227015036.2,
       198243330622303.34, 197976156322273.28,  197709701199363.1,
       197443962353665.03,  197178936900841.3,  196914621972019.8,
       196651014713690.44, 196388112287602.62, 196125911870663.25,
        195864410654835.7, 195603605847039.62, 195343494669051.53,
       195084074357406.06,  194825342163298.1, 194567295352485.75,
       194309931205194.12, 194053247016019.47, 193797240093834.75,
        193541907761695.3, 193287247356745.72, 193033256230127.12,
       192779931746885.47, 192527271285880.38,  192275272239694.7,
       192023932014544.75, 191773248030191.56,  191523217719852.3,
        191273838530112.9,  191025107920841.0, 190777023365099.62,
       190529582349061.88, 190282782371925.78, 190036620945830.16,
       189791095595770.94, 189546203859518.34,  189301943287534.4,
        189058311442891.5, 188815305901191.12, 188572924250483.56,
       188331164091188.06,  188090023036013.7,  187849498709880.7,
       187609588749842.53, 187370290805008.84],
      dtype='float64', name='f'))</pre></div></li></ul></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-2ea9f2fc-1400-4fc9-a86c-53165ce38fd9" type="checkbox"/><label class="xr-section-summary" for="section-2ea9f2fc-1400-4fc9-a86c-53165ce38fd9">Attributes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>W</dd><dt><span>long_name :</span></dt><dd>flux</dd></dl></div></li></ul></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=54a11880">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The data array has <code>.values</code> and <code>.coords</code>. The <code>.values</code> are just the raw, unlabelled data. The <code>.coords</code> are a dictionary mapping each dimension of the data to a set of data. For example, mapping the flux values to a specific frequency. We can inspect them by printing them out.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=9ab36510">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[6]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>array([0.49619535, 0.4959998 , 0.4958456 , 0.49578664, 0.4958678 ,
       0.49604478, 0.49626908, 0.49647027, 0.4966077 , 0.49661922,
       0.49642277, 0.49594647, 0.4951819 , 0.4942104 , 0.4932421 ,
       0.4924945 , 0.4921227 , 0.49211392, 0.49230942, 0.4924388 ,
       0.49224442, 0.49157965, 0.4904679 , 0.48906133, 0.4876103 ,
       0.48636082, 0.4854779 , 0.4849979 , 0.48482403, 0.48475057,
       0.48453504, 0.48398182, 0.48302355, 0.48175392, 0.48037806,
       0.47914445, 0.47820777, 0.47757253, 0.47708204, 0.47651216,
       0.47562975, 0.47437435, 0.4728097 , 0.47111368, 0.4695425 ,
       0.46828848, 0.4674291 , 0.4669524 , 0.46673352, 0.46655577],
      dtype=float32)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=3d873838">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">coords</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[7]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>Coordinates:
  * f        (f) float64 1.999e+14 1.996e+14 1.993e+14 ... 1.876e+14 1.874e+14</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=9afe1b7a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><code>xarray</code> allows us to quickly plot the data. In this case, the plot will just be a 1D line since the data only contains one coordinate. Note that the x and y axis labels are automatically created accordingly.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=d8320e8c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_1.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=bf840aac">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In many cases, we would like to customize the plot. For example, the transmission is often plotted in dB scale. Instead of frequency in Hz as the x axis, wavelength in micron is more standard. In addition, we might want to plot the curve in a certain style. This can be achieved by first extracting the data from the DataArray and manually plotting them using <a href="https://matplotlib.org/" target="_blank">matplotlib</a> or other visualization library of choice.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=e5769563">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># extract frequecies from the monitor data</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">f</span>

<span class="c1"># extract the transmission flux from the monitor data</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span>

<span class="c1"># plot the transmission in dB</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span class="n">freqs</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="s2">"red"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Wavelength ($\mu m$)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Transmission (dB)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_2.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=dae1a0e7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Saving-Data-as-a-CSV-File">Saving Data as a CSV File<a class="anchor-link" href="#Saving-Data-as-a-CSV-File">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=fd8601f6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>After running a simulation, often we want to save the data for future use to avoid rerunning the same simulation. In Tidy3D, after a simulation is finished, the hdf5 data file will be automatically downloaded to the specified path. We can load it in the future as demonstrated at the beginning of this notebook.</p>
<p>Sometimes users might prefer to only save certain data in other formats such as csv files. Here we demonstrate how to save the transmission flux spectrum. First we define a <code>numpy</code> array to store the data and then use the <code>savetxt</code> method to save it as a csv file. This csv file will contain two columns with the first column being the frequencies and the second column being the flux.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=b26c7db1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">flux_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">flux_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">f</span>
<span class="n">flux_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Flux monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">flux</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">"data/flux_data.csv"</span><span class="p">,</span> <span class="n">flux_data</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=380c292b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="ModeMonitor-Data">ModeMonitor Data<a class="anchor-link" href="#ModeMonitor-Data">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=66269876">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The mode monitor data contains the complex effective indices and the complex mode amplitudes at the monitor position calculated by mode decomposition. First, let's look at the data structure of the complex effective indices <code>n_complex</code>. This data contains two coordinates: <code>f</code> and <code>mode_index</code>, both of which are specified when defining the <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.ModeMonitor.html" target="_blank">ModeMonitor</a> in the simulation. In this case specifically, we solved for 3 modes at 50 frequency points for this monitor.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c41e44aa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[11]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<pre class="xr-text-repr-fallback">&lt;xarray.ModeIndexDataArray (f: 50, mode_index: 3)&gt;
array([[2.489277 +0.j, 1.8951759+0.j, 1.5556417+0.j],
       [2.4872196+0.j, 1.8923448+0.j, 1.5539825+0.j],
       [2.4851615+0.j, 1.8895283+0.j, 1.5523468+0.j],
       [2.4831038+0.j, 1.8867241+0.j, 1.55074  +0.j],
       [2.4810426+0.j, 1.8839306+0.j, 1.5491359+0.j],
       [2.4789817+0.j, 1.8811514+0.j, 1.547556 +0.j],
       [2.47692  +0.j, 1.8783836+0.j, 1.5459919+0.j],
       [2.4748576+0.j, 1.8756295+0.j, 1.5444443+0.j],
       [2.4727929+0.j, 1.8728877+0.j, 1.5429138+0.j],
       [2.4707265+0.j, 1.8701544+0.j, 1.5414042+0.j],
       [2.4686599+0.j, 1.8674368+0.j, 1.5399053+0.j],
       [2.4665923+0.j, 1.8647317+0.j, 1.5384263+0.j],
       [2.464523 +0.j, 1.8620384+0.j, 1.5369555+0.j],
       [2.4624531+0.j, 1.8593596+0.j, 1.5355088+0.j],
       [2.4603822+0.j, 1.8566914+0.j, 1.5340687+0.j],
       [2.4583097+0.j, 1.8540373+0.j, 1.5326532+0.j],
       [2.4562361+0.j, 1.8513958+0.j, 1.5312481+0.j],
       [2.454162 +0.j, 1.8487672+0.j, 1.5298533+0.j],
       [2.4520867+0.j, 1.8461518+0.j, 1.52848  +0.j],
       [2.4500098+0.j, 1.8435477+0.j, 1.5271199+0.j],
...
       [2.427097 +0.j, 1.8157864+0.j, 1.5130032+0.j],
       [2.4250083+0.j, 1.813344 +0.j, 1.5117941+0.j],
       [2.422919 +0.j, 1.8109143+0.j, 1.5105985+0.j],
       [2.4208276+0.j, 1.8084954+0.j, 1.5094122+0.j],
       [2.4187353+0.j, 1.8060918+0.j, 1.5082369+0.j],
       [2.4166415+0.j, 1.8037016+0.j, 1.5070716+0.j],
       [2.4145486+0.j, 1.8013238+0.j, 1.5059186+0.j],
       [2.4124515+0.j, 1.7989601+0.j, 1.5047785+0.j],
       [2.4103568+0.j, 1.7966118+0.j, 1.5036418+0.j],
       [2.408259 +0.j, 1.7942752+0.j, 1.5025188+0.j],
       [2.4061618+0.j, 1.7919525+0.j, 1.5014069+0.j],
       [2.4040608+0.j, 1.78964  +0.j, 1.5003092+0.j],
       [2.4019625+0.j, 1.7873462+0.j, 1.4992143+0.j],
       [2.3998604+0.j, 1.785063 +0.j, 1.4981284+0.j],
       [2.3977578+0.j, 1.7827923+0.j, 1.4970543+0.j],
       [2.3956566+0.j, 1.7805377+0.j, 1.4959886+0.j],
       [2.3935518+0.j, 1.7782943+0.j, 1.4949344+0.j],
       [2.3914475+0.j, 1.7760681+0.j, 1.4938891+0.j],
       [2.3893406+0.j, 1.7738496+0.j, 1.4928495+0.j],
       [2.387236 +0.j, 1.7716507+0.j, 1.4918177+0.j]], dtype=complex64)
Coordinates:
  * f           (f) float64 1.999e+14 1.996e+14 ... 1.876e+14 1.874e+14
  * mode_index  (mode_index) int64 0 1 2
Attributes:
    long_name:  Propagation index</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.ModeIndexDataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">f</span>: 50</li><li><span class="xr-has-index">mode_index</span>: 3</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input checked="" class="xr-array-in" id="section-9e9ad581-a4c8-47f5-bb45-5136111f72e6" type="checkbox"/><label for="section-9e9ad581-a4c8-47f5-bb45-5136111f72e6" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>(2.489277+0j) (1.8951759+0j) ... (1.7716507+0j) (1.4918177+0j)</span></div><div class="xr-array-data"><pre>array([[2.489277 +0.j, 1.8951759+0.j, 1.5556417+0.j],
       [2.4872196+0.j, 1.8923448+0.j, 1.5539825+0.j],
       [2.4851615+0.j, 1.8895283+0.j, 1.5523468+0.j],
       [2.4831038+0.j, 1.8867241+0.j, 1.55074  +0.j],
       [2.4810426+0.j, 1.8839306+0.j, 1.5491359+0.j],
       [2.4789817+0.j, 1.8811514+0.j, 1.547556 +0.j],
       [2.47692  +0.j, 1.8783836+0.j, 1.5459919+0.j],
       [2.4748576+0.j, 1.8756295+0.j, 1.5444443+0.j],
       [2.4727929+0.j, 1.8728877+0.j, 1.5429138+0.j],
       [2.4707265+0.j, 1.8701544+0.j, 1.5414042+0.j],
       [2.4686599+0.j, 1.8674368+0.j, 1.5399053+0.j],
       [2.4665923+0.j, 1.8647317+0.j, 1.5384263+0.j],
       [2.464523 +0.j, 1.8620384+0.j, 1.5369555+0.j],
       [2.4624531+0.j, 1.8593596+0.j, 1.5355088+0.j],
       [2.4603822+0.j, 1.8566914+0.j, 1.5340687+0.j],
       [2.4583097+0.j, 1.8540373+0.j, 1.5326532+0.j],
       [2.4562361+0.j, 1.8513958+0.j, 1.5312481+0.j],
       [2.454162 +0.j, 1.8487672+0.j, 1.5298533+0.j],
       [2.4520867+0.j, 1.8461518+0.j, 1.52848  +0.j],
       [2.4500098+0.j, 1.8435477+0.j, 1.5271199+0.j],
...
       [2.427097 +0.j, 1.8157864+0.j, 1.5130032+0.j],
       [2.4250083+0.j, 1.813344 +0.j, 1.5117941+0.j],
       [2.422919 +0.j, 1.8109143+0.j, 1.5105985+0.j],
       [2.4208276+0.j, 1.8084954+0.j, 1.5094122+0.j],
       [2.4187353+0.j, 1.8060918+0.j, 1.5082369+0.j],
       [2.4166415+0.j, 1.8037016+0.j, 1.5070716+0.j],
       [2.4145486+0.j, 1.8013238+0.j, 1.5059186+0.j],
       [2.4124515+0.j, 1.7989601+0.j, 1.5047785+0.j],
       [2.4103568+0.j, 1.7966118+0.j, 1.5036418+0.j],
       [2.408259 +0.j, 1.7942752+0.j, 1.5025188+0.j],
       [2.4061618+0.j, 1.7919525+0.j, 1.5014069+0.j],
       [2.4040608+0.j, 1.78964  +0.j, 1.5003092+0.j],
       [2.4019625+0.j, 1.7873462+0.j, 1.4992143+0.j],
       [2.3998604+0.j, 1.785063 +0.j, 1.4981284+0.j],
       [2.3977578+0.j, 1.7827923+0.j, 1.4970543+0.j],
       [2.3956566+0.j, 1.7805377+0.j, 1.4959886+0.j],
       [2.3935518+0.j, 1.7782943+0.j, 1.4949344+0.j],
       [2.3914475+0.j, 1.7760681+0.j, 1.4938891+0.j],
       [2.3893406+0.j, 1.7738496+0.j, 1.4928495+0.j],
       [2.387236 +0.j, 1.7716507+0.j, 1.4918177+0.j]], dtype=complex64)</pre></div></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-d9dc4714-dcc3-41ec-8d3d-0c3a8f29063e" type="checkbox"/><label class="xr-section-summary" for="section-d9dc4714-dcc3-41ec-8d3d-0c3a8f29063e">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">f</span></div><div class="xr-var-dims">(f)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.999e+14 1.996e+14 ... 1.874e+14</div><input class="xr-var-attrs-in" id="attrs-411f10c1-bca2-4420-9b57-8e53e4864df1" type="checkbox"/><label for="attrs-411f10c1-bca2-4420-9b57-8e53e4864df1" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-05fe2079-cda3-42fd-8e42-d76f560408ba" type="checkbox"/><label for="data-05fe2079-cda3-42fd-8e42-d76f560408ba" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>Hz</dd><dt><span>long_name :</span></dt><dd>frequency</dd></dl></div><div class="xr-var-data"><pre>array([1.998616e+14, 1.995901e+14, 1.993193e+14, 1.990492e+14, 1.987798e+14,
       1.985112e+14, 1.982433e+14, 1.979762e+14, 1.977097e+14, 1.974440e+14,
       1.971789e+14, 1.969146e+14, 1.966510e+14, 1.963881e+14, 1.961259e+14,
       1.958644e+14, 1.956036e+14, 1.953435e+14, 1.950841e+14, 1.948253e+14,
       1.945673e+14, 1.943099e+14, 1.940532e+14, 1.937972e+14, 1.935419e+14,
       1.932872e+14, 1.930333e+14, 1.927799e+14, 1.925273e+14, 1.922753e+14,
       1.920239e+14, 1.917732e+14, 1.915232e+14, 1.912738e+14, 1.910251e+14,
       1.907770e+14, 1.905296e+14, 1.902828e+14, 1.900366e+14, 1.897911e+14,
       1.895462e+14, 1.893019e+14, 1.890583e+14, 1.888153e+14, 1.885729e+14,
       1.883312e+14, 1.880900e+14, 1.878495e+14, 1.876096e+14, 1.873703e+14])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">mode_index</span></div><div class="xr-var-dims">(mode_index)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2</div><input class="xr-var-attrs-in" id="attrs-2dc6947e-2add-4769-b38d-4313b8b5c751" type="checkbox"/><label for="attrs-2dc6947e-2add-4769-b38d-4313b8b5c751" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-3268cf16-f4d3-40c6-8bb1-77472d8a948c" type="checkbox"/><label for="data-3268cf16-f4d3-40c6-8bb1-77472d8a948c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>mode index</dd></dl></div><div class="xr-var-data"><pre>array([0, 1, 2], dtype=int64)</pre></div></li></ul></div></li><li class="xr-section-item"><input class="xr-section-summary-in" id="section-6c0bc659-cf65-45ce-a1be-13a2a9763c07" type="checkbox"/><label class="xr-section-summary" for="section-6c0bc659-cf65-45ce-a1be-13a2a9763c07">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>f</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-e9a6223e-4a09-464e-be2d-b1a0e4023f15" type="checkbox"/><label for="index-e9a6223e-4a09-464e-be2d-b1a0e4023f15" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([199861643525342.56, 199590092379248.34,  199319278142641.5,
        199049197819955.0, 198779848431835.97,  198511227015036.2,
       198243330622303.34, 197976156322273.28,  197709701199363.1,
       197443962353665.03,  197178936900841.3,  196914621972019.8,
       196651014713690.44, 196388112287602.62, 196125911870663.25,
        195864410654835.7, 195603605847039.62, 195343494669051.53,
       195084074357406.06,  194825342163298.1, 194567295352485.75,
       194309931205194.12, 194053247016019.47, 193797240093834.75,
        193541907761695.3, 193287247356745.72, 193033256230127.12,
       192779931746885.47, 192527271285880.38,  192275272239694.7,
       192023932014544.75, 191773248030191.56,  191523217719852.3,
        191273838530112.9,  191025107920841.0, 190777023365099.62,
       190529582349061.88, 190282782371925.78, 190036620945830.16,
       189791095595770.94, 189546203859518.34,  189301943287534.4,
        189058311442891.5, 188815305901191.12, 188572924250483.56,
       188331164091188.06,  188090023036013.7,  187849498709880.7,
       187609588749842.53, 187370290805008.84],
      dtype='float64', name='f'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>mode_index</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-3699ae94-d5f5-4d41-a35a-9bce61ef7079" type="checkbox"/><label for="index-3699ae94-d5f5-4d41-a35a-9bce61ef7079" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2], dtype='int64', name='mode_index'))</pre></div></li></ul></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-5fa4f9d2-d728-4dcb-9d5b-165a773b4197" type="checkbox"/><label class="xr-section-summary" for="section-5fa4f9d2-d728-4dcb-9d5b-165a773b4197">Attributes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>Propagation index</dd></dl></div></li></ul></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=3218c5e4">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Data-Selection/Slicing">Data Selection/Slicing<a class="anchor-link" href="#Data-Selection/Slicing">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8375fca4">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>For multidimensional data, it's important to slice them correctly to extract the data that we are looking for. For example, assume that we want to plot the effective indices as a function of frequency for each mode. This can be easily achieved by using the <a href="https://docs.xarray.dev/en/v2022.03.0/generated/xarray.Dataset.isel.html" target="_blank">sel</a> method of <code>xarray</code>.</p>
<p>After slicing the data, we can directly plot it on a <code>matplotlib</code> axis so we can style the plot after plotting it.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=71e99ed3">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># define a matplotlib axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># slice the monitor data and plot it on the axis</span>
<span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># style the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Effective indices of three modes"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"mode 1"</span><span class="p">,</span> <span class="s2">"mode 2"</span><span class="p">,</span> <span class="s2">"mode 3"</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_3.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b29f0dca">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In <code>sel</code>, we can specify multiple coordinates at the same time. For example, we want to extract the effective index of the first mode (index 0) at the highest frequency.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=2e8b9aa7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">n_eff</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"The effective index for the first mode at </span><span class="si">{</span><span class="mf">1e3</span><span class="o">*</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span><span class="o">/</span><span class="n">freqs</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> nm is </span><span class="si">{</span><span class="n">n_eff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">."</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>The effective index for the first mode at 1500.000 nm is 2.489.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=2b5b4844">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Equivalently, the same can be achieved by using <a href="https://docs.xarray.dev/en/v2022.03.0/generated/xarray.Dataset.isel.html" target="_blank">isel</a>, which stands for index selection. Unlike <code>sel</code>, which selects at specific coordinate values, <code>isel</code> selects at specific coordinate index. For example, the highest frequency is the index 0 of the frequency coordinate. Therefore, <code>isel(mode_index=0, f=0)</code> will give the same result as <code>sel(mode_index=0, f=freqs[0])</code>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=1ac2057d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">n_eff</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">n_complex</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"The effective index for the first mode at </span><span class="si">{</span><span class="mf">1e3</span><span class="o">*</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span><span class="o">/</span><span class="n">freqs</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> nm is </span><span class="si">{</span><span class="n">n_eff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">."</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>The effective index for the first mode at 1500.000 nm is 2.489.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=fbe4d7aa">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Besides the effective index, <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.ModeMonitor.html" target="_blank">ModeMonitor</a> is primarily used to calculate the transmission of certain modes in certain directions. We can extract the complex amplitude and square it to compute the mode transmission power.</p>
<p>In addition to the support of standard mathematical operations (<code>+</code>, <code>-</code>, <code>*</code>, <code>**</code>), <code>xarray</code> is also compatible with <a href="https://numpy.org/" target="_blank">numpy</a> so we can directly apply <code>numpy</code> operations such as <code>square</code> to an <code>xarray</code> DataArray. As a demonstration, we extract the transmission of the fundamental mode in the positive direction (<code>sel(mode_index=0, direction='+')</code>), take the absolute value (<code>.abs</code>), and square it using <code>numpy</code>. Then we can plot it in dB scale. The plot is similar to the previous plot from <code>Flux monitor</code>, which is expected as the waveguide is single mode and most of the transmitted power is at the fundamental mode.</p>
<p>Note that in Tidy3D, we implemented additional convenient functionalities that are not avaiable in the origianl <code>xarray</code>. Taking the absolute value (<code>.abs</code>) is one example. One can achieve the same result by using <code>abs()</code> on an DataArray.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c255d12e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># extract complex mode amplitude and calculate transmission power</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Mode monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">amps</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mode_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">"+"</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">)</span>

<span class="c1"># plot the transmission spectrum</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span class="n">freqs</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="s2">"red"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Wavelength ($\mu m$)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Transmission (dB)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_4.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a8fd1ba9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="FieldMonitor-Data">FieldMonitor Data<a class="anchor-link" href="#FieldMonitor-Data">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=bf76d734">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Finally let's examine the data in <code>Field monitor</code>. This dataset contains all electric and magnetic field components: <code>Ex</code>, <code>Ey</code>, <code>Ez</code>, <code>Hx</code>, <code>Hy</code>, and <code>Hz</code>. Let's use <code>Hz</code> as an example to explore some visualization possibilities.</p>
<p>This array has 4 coordinates: three spatial coordinates and one frequency coordinate.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=fcf0dc88">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Field monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">Hz</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[16]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<pre class="xr-text-repr-fallback">&lt;xarray.ScalarFieldDataArray (x: 639, y: 71, z: 4, f: 3)&gt;
array([[[[-4.21197501e-13-7.63092253e-14j,
           2.06759574e-14+1.06486902e-13j,
          -5.45012169e-13+1.84023478e-13j],
         [ 1.72903887e-13+7.30291817e-14j,
           6.28276050e-14-2.33233300e-13j,
           1.06661121e-12-1.47368811e-13j],
         [-1.45802099e-13-9.70202583e-14j,
          -6.83223077e-14+1.50096800e-13j,
          -1.01692168e-12+1.69137138e-13j],
         [-1.66980999e-13-4.46525378e-14j,
          -6.44609081e-14+1.04707238e-13j,
          -7.64654182e-13+1.56975561e-13j]],

        [[ 1.83680789e-14-6.91012189e-13j,
           1.55601953e-12+9.88327367e-13j,
          -2.74072670e-12+1.58785116e-12j],
         [ 7.05131808e-13-8.20385426e-13j,
           8.60337897e-13+5.32298543e-13j,
          -2.65417007e-12-9.85616970e-13j],
         [ 5.99199238e-13-7.92176383e-13j,
...
          -3.72196550e-13+1.77992034e-13j],
         [ 1.17384121e-14-1.41757672e-13j,
           1.57059980e-13+2.16227996e-13j,
           4.11576616e-13-1.58133448e-13j],
         [ 2.44148692e-14-1.44831968e-13j,
           1.07231030e-13+1.80186378e-13j,
           2.91607043e-13-1.04423543e-13j]],

        [[ 5.06348842e-14-4.29277484e-14j,
           1.18457295e-14+9.13331910e-14j,
           1.09568807e-13-7.53448004e-14j],
         [-4.63693618e-14+4.68727399e-14j,
          -1.57478841e-14-1.07168458e-13j,
          -1.38530151e-13+8.91796877e-14j],
         [ 4.53232422e-14-8.81930501e-14j,
           1.54002956e-14+1.45535100e-13j,
           1.25600878e-13-6.35340440e-14j],
         [ 3.75325754e-14-6.70172400e-14j,
           9.84553236e-15+1.09919554e-13j,
           1.00585596e-13-5.27222749e-14j]]]], dtype=complex64)
Coordinates:
  * x        (x) float64 -28.33 -28.24 -28.16 -28.07 ... 28.11 28.2 28.29 28.33
  * y        (y) float64 -4.203 -3.996 -3.789 -3.583 ... 3.583 3.789 3.996 4.203
  * z        (z) float64 -0.11 -0.022 0.066 0.11
  * f        (f) float64 1.999e+14 1.934e+14 1.874e+14
Attributes:
    long_name:  field value</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.ScalarFieldDataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">x</span>: 639</li><li><span class="xr-has-index">y</span>: 71</li><li><span class="xr-has-index">z</span>: 4</li><li><span class="xr-has-index">f</span>: 3</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input checked="" class="xr-array-in" id="section-658568d4-1910-41de-b1d0-b8d81a9c5e90" type="checkbox"/><label for="section-658568d4-1910-41de-b1d0-b8d81a9c5e90" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>(-4.211975e-13-7.6309225e-14j) ... (1.00585596e-13-5.2722275e-14j)</span></div><div class="xr-array-data"><pre>array([[[[-4.21197501e-13-7.63092253e-14j,
           2.06759574e-14+1.06486902e-13j,
          -5.45012169e-13+1.84023478e-13j],
         [ 1.72903887e-13+7.30291817e-14j,
           6.28276050e-14-2.33233300e-13j,
           1.06661121e-12-1.47368811e-13j],
         [-1.45802099e-13-9.70202583e-14j,
          -6.83223077e-14+1.50096800e-13j,
          -1.01692168e-12+1.69137138e-13j],
         [-1.66980999e-13-4.46525378e-14j,
          -6.44609081e-14+1.04707238e-13j,
          -7.64654182e-13+1.56975561e-13j]],

        [[ 1.83680789e-14-6.91012189e-13j,
           1.55601953e-12+9.88327367e-13j,
          -2.74072670e-12+1.58785116e-12j],
         [ 7.05131808e-13-8.20385426e-13j,
           8.60337897e-13+5.32298543e-13j,
          -2.65417007e-12-9.85616970e-13j],
         [ 5.99199238e-13-7.92176383e-13j,
...
          -3.72196550e-13+1.77992034e-13j],
         [ 1.17384121e-14-1.41757672e-13j,
           1.57059980e-13+2.16227996e-13j,
           4.11576616e-13-1.58133448e-13j],
         [ 2.44148692e-14-1.44831968e-13j,
           1.07231030e-13+1.80186378e-13j,
           2.91607043e-13-1.04423543e-13j]],

        [[ 5.06348842e-14-4.29277484e-14j,
           1.18457295e-14+9.13331910e-14j,
           1.09568807e-13-7.53448004e-14j],
         [-4.63693618e-14+4.68727399e-14j,
          -1.57478841e-14-1.07168458e-13j,
          -1.38530151e-13+8.91796877e-14j],
         [ 4.53232422e-14-8.81930501e-14j,
           1.54002956e-14+1.45535100e-13j,
           1.25600878e-13-6.35340440e-14j],
         [ 3.75325754e-14-6.70172400e-14j,
           9.84553236e-15+1.09919554e-13j,
           1.00585596e-13-5.27222749e-14j]]]], dtype=complex64)</pre></div></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-00c2e108-9cef-4ca1-8cc0-dfe7deeae265" type="checkbox"/><label class="xr-section-summary" for="section-00c2e108-9cef-4ca1-8cc0-dfe7deeae265">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-28.33 -28.24 ... 28.29 28.33</div><input class="xr-var-attrs-in" id="attrs-8bd9754b-ea2e-4e39-a43d-ebd611a16f74" type="checkbox"/><label for="attrs-8bd9754b-ea2e-4e39-a43d-ebd611a16f74" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-a4036d12-d50a-41c0-ac2f-df65aa5bf270" type="checkbox"/><label for="data-a4036d12-d50a-41c0-ac2f-df65aa5bf270" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>x position</dd></dl></div><div class="xr-var-data"><pre>array([-28.333333, -28.244444, -28.155556, ...,  28.2     ,  28.288889,
        28.333333])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-4.203 -3.996 ... 3.996 4.203</div><input class="xr-var-attrs-in" id="attrs-b26b11eb-348d-4143-b8f4-130b91f894c0" type="checkbox"/><label for="attrs-b26b11eb-348d-4143-b8f4-130b91f894c0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-8459aba1-4f33-41f9-ae28-95418db6dcb7" type="checkbox"/><label for="data-8459aba1-4f33-41f9-ae28-95418db6dcb7" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>y position</dd></dl></div><div class="xr-var-data"><pre>array([-4.202639, -3.995949, -3.78926 , -3.58257 , -3.37588 , -3.16919 ,
       -2.9625  , -2.75581 , -2.54912 , -2.34243 , -2.13574 , -1.947415,
       -1.843357, -1.757143, -1.671429, -1.585714, -1.5     , -1.4125  ,
       -1.325   , -1.2375  , -1.15    , -1.0659  , -0.978998, -0.892095,
       -0.805192, -0.718289, -0.65    , -0.6     , -0.535917, -0.454367,
       -0.372817, -0.3     , -0.25    , -0.180811, -0.092763, -0.004715,
        0.083333,  0.171382,  0.25    ,  0.3     ,  0.372817,  0.454367,
        0.535917,  0.6     ,  0.65    ,  0.718289,  0.805192,  0.892095,
        0.978998,  1.0659  ,  1.15    ,  1.2375  ,  1.325   ,  1.4125  ,
        1.5     ,  1.585714,  1.671429,  1.757143,  1.843357,  1.947415,
        2.13574 ,  2.34243 ,  2.54912 ,  2.75581 ,  2.9625  ,  3.16919 ,
        3.37588 ,  3.58257 ,  3.78926 ,  3.995949,  4.202639])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">z</span></div><div class="xr-var-dims">(z)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.11 -0.022 0.066 0.11</div><input class="xr-var-attrs-in" id="attrs-72ff2176-d061-4c53-9599-ea3a43b9576c" type="checkbox"/><label for="attrs-72ff2176-d061-4c53-9599-ea3a43b9576c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-f64ed7c7-0efb-45ff-b2a4-5e98112a29ca" type="checkbox"/><label for="data-f64ed7c7-0efb-45ff-b2a4-5e98112a29ca" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>z position</dd></dl></div><div class="xr-var-data"><pre>array([-0.11 , -0.022,  0.066,  0.11 ])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">f</span></div><div class="xr-var-dims">(f)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.999e+14 1.934e+14 1.874e+14</div><input class="xr-var-attrs-in" id="attrs-bc524ea1-b99e-475c-a621-cac1c3348b5b" type="checkbox"/><label for="attrs-bc524ea1-b99e-475c-a621-cac1c3348b5b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-19fc492e-2c0c-4356-a2fb-649d89fbc6ba" type="checkbox"/><label for="data-19fc492e-2c0c-4356-a2fb-649d89fbc6ba" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>Hz</dd><dt><span>long_name :</span></dt><dd>frequency</dd></dl></div><div class="xr-var-data"><pre>array([1.998616e+14, 1.934145e+14, 1.873703e+14])</pre></div></li></ul></div></li><li class="xr-section-item"><input class="xr-section-summary-in" id="section-db174714-500c-44bb-beae-18340b241c63" type="checkbox"/><label class="xr-section-summary" for="section-db174714-500c-44bb-beae-18340b241c63">Indexes: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-837cdb93-50b9-4780-95ff-e9d68086f210" type="checkbox"/><label for="index-837cdb93-50b9-4780-95ff-e9d68086f210" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([-28.333333333333332, -28.244444444444444, -28.155555555555555,
       -28.066666666666666, -27.977777777777778,  -27.88888888888889,
                     -27.8, -27.711111111111112, -27.622222222222224,
       -27.533333333333335,
       ...
         27.57777777777881,  27.666666666667698,  27.755555555556587,
        27.844444444443415,  27.933333333330243,   28.02222222221707,
          28.1111111111039,  28.199999999990727,  28.288888888877555,
         28.33333333332097],
      dtype='float64', name='x', length=639))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-ace5eb35-a8c5-448e-9b64-06ccd5e00441" type="checkbox"/><label for="index-ace5eb35-a8c5-448e-9b64-06ccd5e00441" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([    -4.202639377094743,    -3.9959494809122855,    -3.7892595847298285,
          -3.5825696885473715,    -3.3758797923649144,    -3.1691898961824574,
          -2.9625000000000004,     -2.755810103817543,     -2.549120207635086,
          -2.3424303114526284,    -2.1357404152701713,    -1.9474150351508217,
          -1.8433573632796536,    -1.7571428571428573,    -1.6714285714285715,
          -1.5857142857142856,    -1.4999999999999998,    -1.4124999999999999,
                       -1.325,                -1.2375,    -1.1500000000000001,
            -1.06590042512647,     -0.978997531090489,    -0.8920946370545075,
           -0.805191743018526,    -0.7182888489825445,     -0.649999999999999,
          -0.5999999999999992,    -0.5359172257355991,   -0.45436689029423905,
           -0.372816554852879,    -0.2999999999999985,   -0.24999999999999867,
         -0.18081118394597295,   -0.09276301151953703, -0.0047148390931006645,
           0.0833333333333357,    0.17138150575977207,     0.2500000000000031,
          0.30000000000000293,    0.37281655485288345,     0.4543668902942435,
           0.5359172257356035,     0.6000000000000036,     0.6500000000000035,
            0.718288848982549,     0.8051917430185305,      0.892094637054512,
           0.9789975310904935,     1.0659004251264745,     1.1500000000000048,
           1.2375000000000052,     1.3250000000000055,     1.4125000000000059,
           1.5000000000000062,     1.5857142857142916,      1.671428571428577,
           1.7571428571428624,      1.843357363279659,     1.9474150351508275,
           2.1357404152701767,     2.3424303114526337,     2.5491202076350907,
           2.7558101038175478,     2.9625000000000004,     3.1691898961824485,
           3.3758797923648967,      3.582569688547345,      3.789259584729793,
            3.995949480912241,      4.202639377094689],
      dtype='float64', name='y'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>z</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-04ed975a-ff2f-4dbd-a297-9d9c0b7973e7" type="checkbox"/><label for="index-04ed975a-ff2f-4dbd-a297-9d9c0b7973e7" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([ -0.1100000000000001, -0.02200000000000002,  0.06600000000000006,
         0.1100000000000001],
      dtype='float64', name='z'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>f</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-b6413bd3-d7f1-4719-97d4-54e0a12d8d65" type="checkbox"/><label for="index-b6413bd3-d7f1-4719-97d4-54e0a12d8d65" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([199861643525342.66, 193414493734202.56, 187370290805008.75], dtype='float64', name='f'))</pre></div></li></ul></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-f861794c-0697-493c-a1b6-c94edf514a29" type="checkbox"/><label class="xr-section-summary" for="section-f861794c-0697-493c-a1b6-c94edf514a29">Attributes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>field value</dd></dl></div></li></ul></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=90c444a8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We can slice the data in the same way using <code>sel</code> and(or) <code>isel</code>. Let's look at the <code>Hz</code> field at the first frequency (1500 nm) and z=0 plane. When using <code>sel</code>, it's important to note that the specific coordinate value might not be available in the data. For example, the z coordinate contains four values, namely -0.11, -0.022, 0.066, and 0.11. That is, z=0 is not available. We can specify <code>method='nearest'</code> in the selection such that it automatically extracts the data at the nearest plane, e.g. z=-0.022.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=4833fb8d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sim_data</span><span class="p">[</span><span class="s2">"Field monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">Hz</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"nearest"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">[17]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<pre class="xr-text-repr-fallback">&lt;xarray.ScalarFieldDataArray (x: 639, y: 71)&gt;
array([[ 1.72903887e-13+7.30291817e-14j,  7.05131808e-13-8.20385426e-13j,
        -4.10750562e-13-1.32187230e-11j, ...,
         2.20327619e-12+2.00806880e-14j, -2.93731185e-13+3.05212940e-13j,
        -8.45800548e-14+2.77022573e-13j],
       [-2.07527363e-11+9.06220411e-12j,  1.73980080e-10-7.17077953e-10j,
         5.30298161e-09-3.85799659e-09j, ...,
         1.53273738e-09-1.78293558e-09j, -1.13150746e-10-1.01174555e-10j,
         9.96051982e-13+1.79779379e-12j],
       [-1.84707982e-09+2.74981615e-09j, -2.47840379e-08-9.69261080e-08j,
         4.35158171e-07-5.78295271e-07j, ...,
         7.09929466e-08-3.01665466e-07j, -2.05956585e-08-4.81508300e-09j,
         1.10313522e-10+8.91196908e-11j],
       ...,
       [-1.03232742e-10+8.24886166e-12j,  2.28711539e-09-1.38926426e-09j,
         1.25055974e-08+1.50453268e-08j, ...,
         8.53952109e-09+3.09128767e-09j, -1.86159352e-10-5.29092270e-10j,
         9.32336239e-13+7.03187899e-12j],
       [-1.80652870e-13-7.85726803e-14j,  1.38683303e-12-4.83263006e-13j,
         1.98963827e-12+1.07613978e-11j, ...,
         5.02892346e-12+3.87518316e-12j,  5.12411565e-14-1.53012545e-13j,
        -5.88365687e-14+1.36643653e-13j],
       [-5.79908097e-14-4.90087910e-14j, -1.08373292e-13-2.28382634e-13j,
        -1.74725566e-12-1.37564834e-14j, ...,
         6.79223875e-13+7.33959402e-14j, -1.36950667e-14+7.32532185e-14j,
        -4.63693618e-14+4.68727399e-14j]], dtype=complex64)
Coordinates:
  * x        (x) float64 -28.33 -28.24 -28.16 -28.07 ... 28.11 28.2 28.29 28.33
  * y        (y) float64 -4.203 -3.996 -3.789 -3.583 ... 3.583 3.789 3.996 4.203
    z        float64 -0.022
    f        float64 1.999e+14
Attributes:
    long_name:  field value</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.ScalarFieldDataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">x</span>: 639</li><li><span class="xr-has-index">y</span>: 71</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input checked="" class="xr-array-in" id="section-30bb921c-1937-4782-b57e-1f792c774ba2" type="checkbox"/><label for="section-30bb921c-1937-4782-b57e-1f792c774ba2" title="Show/hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>(1.7290389e-13+7.302918e-14j) ... (-4.6369362e-14+4.687274e-14j)</span></div><div class="xr-array-data"><pre>array([[ 1.72903887e-13+7.30291817e-14j,  7.05131808e-13-8.20385426e-13j,
        -4.10750562e-13-1.32187230e-11j, ...,
         2.20327619e-12+2.00806880e-14j, -2.93731185e-13+3.05212940e-13j,
        -8.45800548e-14+2.77022573e-13j],
       [-2.07527363e-11+9.06220411e-12j,  1.73980080e-10-7.17077953e-10j,
         5.30298161e-09-3.85799659e-09j, ...,
         1.53273738e-09-1.78293558e-09j, -1.13150746e-10-1.01174555e-10j,
         9.96051982e-13+1.79779379e-12j],
       [-1.84707982e-09+2.74981615e-09j, -2.47840379e-08-9.69261080e-08j,
         4.35158171e-07-5.78295271e-07j, ...,
         7.09929466e-08-3.01665466e-07j, -2.05956585e-08-4.81508300e-09j,
         1.10313522e-10+8.91196908e-11j],
       ...,
       [-1.03232742e-10+8.24886166e-12j,  2.28711539e-09-1.38926426e-09j,
         1.25055974e-08+1.50453268e-08j, ...,
         8.53952109e-09+3.09128767e-09j, -1.86159352e-10-5.29092270e-10j,
         9.32336239e-13+7.03187899e-12j],
       [-1.80652870e-13-7.85726803e-14j,  1.38683303e-12-4.83263006e-13j,
         1.98963827e-12+1.07613978e-11j, ...,
         5.02892346e-12+3.87518316e-12j,  5.12411565e-14-1.53012545e-13j,
        -5.88365687e-14+1.36643653e-13j],
       [-5.79908097e-14-4.90087910e-14j, -1.08373292e-13-2.28382634e-13j,
        -1.74725566e-12-1.37564834e-14j, ...,
         6.79223875e-13+7.33959402e-14j, -1.36950667e-14+7.32532185e-14j,
        -4.63693618e-14+4.68727399e-14j]], dtype=complex64)</pre></div></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-64a40664-ae31-4584-8e58-e0c956401923" type="checkbox"/><label class="xr-section-summary" for="section-64a40664-ae31-4584-8e58-e0c956401923">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-28.33 -28.24 ... 28.29 28.33</div><input class="xr-var-attrs-in" id="attrs-5b96bb5d-224e-443e-a0d8-c0f8de08633c" type="checkbox"/><label for="attrs-5b96bb5d-224e-443e-a0d8-c0f8de08633c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-9f74fa16-4183-47d9-bff6-c1492c37a5b0" type="checkbox"/><label for="data-9f74fa16-4183-47d9-bff6-c1492c37a5b0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>x position</dd></dl></div><div class="xr-var-data"><pre>array([-28.333333, -28.244444, -28.155556, ...,  28.2     ,  28.288889,
        28.333333])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-4.203 -3.996 ... 3.996 4.203</div><input class="xr-var-attrs-in" id="attrs-3dba62e4-e315-4754-ae24-79dab8f4c294" type="checkbox"/><label for="attrs-3dba62e4-e315-4754-ae24-79dab8f4c294" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-6b1b4f55-e7a0-4c6f-bd9b-8244cca29b36" type="checkbox"/><label for="data-6b1b4f55-e7a0-4c6f-bd9b-8244cca29b36" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>y position</dd></dl></div><div class="xr-var-data"><pre>array([-4.202639, -3.995949, -3.78926 , -3.58257 , -3.37588 , -3.16919 ,
       -2.9625  , -2.75581 , -2.54912 , -2.34243 , -2.13574 , -1.947415,
       -1.843357, -1.757143, -1.671429, -1.585714, -1.5     , -1.4125  ,
       -1.325   , -1.2375  , -1.15    , -1.0659  , -0.978998, -0.892095,
       -0.805192, -0.718289, -0.65    , -0.6     , -0.535917, -0.454367,
       -0.372817, -0.3     , -0.25    , -0.180811, -0.092763, -0.004715,
        0.083333,  0.171382,  0.25    ,  0.3     ,  0.372817,  0.454367,
        0.535917,  0.6     ,  0.65    ,  0.718289,  0.805192,  0.892095,
        0.978998,  1.0659  ,  1.15    ,  1.2375  ,  1.325   ,  1.4125  ,
        1.5     ,  1.585714,  1.671429,  1.757143,  1.843357,  1.947415,
        2.13574 ,  2.34243 ,  2.54912 ,  2.75581 ,  2.9625  ,  3.16919 ,
        3.37588 ,  3.58257 ,  3.78926 ,  3.995949,  4.202639])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>z</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.022</div><input class="xr-var-attrs-in" id="attrs-4f16c75c-997e-4c82-a243-6d1d3fc09d0b" type="checkbox"/><label for="attrs-4f16c75c-997e-4c82-a243-6d1d3fc09d0b" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-748da308-3776-4e03-91db-13f4427278d0" type="checkbox"/><label for="data-748da308-3776-4e03-91db-13f4427278d0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>um</dd><dt><span>long_name :</span></dt><dd>z position</dd></dl></div><div class="xr-var-data"><pre>array(-0.022)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>f</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">1.999e+14</div><input class="xr-var-attrs-in" id="attrs-660c0a47-07e5-49e3-9743-9de4f73a0eb9" type="checkbox"/><label for="attrs-660c0a47-07e5-49e3-9743-9de4f73a0eb9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use xlink:href="#icon-file-text2"></use></svg></label><input class="xr-var-data-in" id="data-c8b249c2-2643-4337-b728-1fb93289747d" type="checkbox"/><label for="data-c8b249c2-2643-4337-b728-1fb93289747d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>Hz</dd><dt><span>long_name :</span></dt><dd>frequency</dd></dl></div><div class="xr-var-data"><pre>array(1.99861644e+14)</pre></div></li></ul></div></li><li class="xr-section-item"><input class="xr-section-summary-in" id="section-c066cd14-681a-43fd-a08a-8aa3a42230bd" type="checkbox"/><label class="xr-section-summary" for="section-c066cd14-681a-43fd-a08a-8aa3a42230bd">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-219e4412-75d4-41e3-acd9-4fbe83ae5b0f" type="checkbox"/><label for="index-219e4412-75d4-41e3-acd9-4fbe83ae5b0f" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([-28.333333333333332, -28.244444444444444, -28.155555555555555,
       -28.066666666666666, -27.977777777777778,  -27.88888888888889,
                     -27.8, -27.711111111111112, -27.622222222222224,
       -27.533333333333335,
       ...
         27.57777777777881,  27.666666666667698,  27.755555555556587,
        27.844444444443415,  27.933333333330243,   28.02222222221707,
          28.1111111111039,  28.199999999990727,  28.288888888877555,
         28.33333333332097],
      dtype='float64', name='x', length=639))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input class="xr-index-data-in" id="index-6f9f03b7-0e7b-477f-be1a-3dd6afb0c554" type="checkbox"/><label for="index-6f9f03b7-0e7b-477f-be1a-3dd6afb0c554" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use xlink:href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([    -4.202639377094743,    -3.9959494809122855,    -3.7892595847298285,
          -3.5825696885473715,    -3.3758797923649144,    -3.1691898961824574,
          -2.9625000000000004,     -2.755810103817543,     -2.549120207635086,
          -2.3424303114526284,    -2.1357404152701713,    -1.9474150351508217,
          -1.8433573632796536,    -1.7571428571428573,    -1.6714285714285715,
          -1.5857142857142856,    -1.4999999999999998,    -1.4124999999999999,
                       -1.325,                -1.2375,    -1.1500000000000001,
            -1.06590042512647,     -0.978997531090489,    -0.8920946370545075,
           -0.805191743018526,    -0.7182888489825445,     -0.649999999999999,
          -0.5999999999999992,    -0.5359172257355991,   -0.45436689029423905,
           -0.372816554852879,    -0.2999999999999985,   -0.24999999999999867,
         -0.18081118394597295,   -0.09276301151953703, -0.0047148390931006645,
           0.0833333333333357,    0.17138150575977207,     0.2500000000000031,
          0.30000000000000293,    0.37281655485288345,     0.4543668902942435,
           0.5359172257356035,     0.6000000000000036,     0.6500000000000035,
            0.718288848982549,     0.8051917430185305,      0.892094637054512,
           0.9789975310904935,     1.0659004251264745,     1.1500000000000048,
           1.2375000000000052,     1.3250000000000055,     1.4125000000000059,
           1.5000000000000062,     1.5857142857142916,      1.671428571428577,
           1.7571428571428624,      1.843357363279659,     1.9474150351508275,
           2.1357404152701767,     2.3424303114526337,     2.5491202076350907,
           2.7558101038175478,     2.9625000000000004,     3.1691898961824485,
           3.3758797923648967,      3.582569688547345,      3.789259584729793,
            3.995949480912241,      4.202639377094689],
      dtype='float64', name='y'))</pre></div></li></ul></div></li><li class="xr-section-item"><input checked="" class="xr-section-summary-in" id="section-e4bf8b0e-bdaf-4db6-bf11-3c480ce6951e" type="checkbox"/><label class="xr-section-summary" for="section-e4bf8b0e-bdaf-4db6-bf11-3c480ce6951e">Attributes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>field value</dd></dl></div></li></ul></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=7c447b6f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>After slicing, the data is 2D so it can be plotted as a false color plot. When using the <code>plot</code> method, we can specify which coordinate is plotted on the horizontal axis, which coordinate is plotted on the vertical axis, what colormap is used, min and max values of the color scale, etc.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=60881279">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hz_1500</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Field monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">Hz</span><span class="o">.</span><span class="n">abs</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"nearest"</span><span class="p">)</span>
<span class="n">Hz_1500</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_5.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=faf52a34">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Similarly, we can easily extract and plot the field at 1550 nm.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5135eb8d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hz_1550</span> <span class="o">=</span> <span class="n">sim_data</span><span class="p">[</span><span class="s2">"Field monitor"</span><span class="p">]</span><span class="o">.</span><span class="n">Hz</span><span class="o">.</span><span class="n">abs</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span class="mf">1.55</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">"nearest"</span><span class="p">)</span>
<span class="n">Hz_1550</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_6.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6ab0935a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Data-Interpolation">Data Interpolation<a class="anchor-link" href="#Data-Interpolation">¶</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=d6120864">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The field data are most likely located in a nonlinear grid. However, <code>xarray</code> allows us to interpolate data at arbitrary coordinates easily. As a demonstration, we define a linear grid and interpolate the <code>Hz</code> field to this grid by using the <code>interp</code> method.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=94a6791a">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">Hz_1550</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_interp</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_interp</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_7.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a7aea4f0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Similarly, we can save the field data as a csv file for future use.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=9623e9f0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Hz_data</span> <span class="o">=</span> <span class="n">Hz_1550</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_interp</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_interp</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">"data/field_data.csv"</span><span class="p">,</span> <span class="n">Hz_data</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=47e20609">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Integration">Integration<a class="anchor-link" href="#Integration">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ce50cd69">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Sometimes the postprocessing of the simulation data requires the calculation of certain integrals. A common example is the calculation of the overlap integral of two modes. For instance, when designing an <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/EdgeCoupler/" target="_blank">edge coupler</a>, we might want to calculate the overlap integral of the fiber mode and the waveguide mode. In Tidy3D, we provide a convenient function <code>outer_dot</code> that does this integral.</p>
<p>To demonstrate this, we load data from two hdf5 files. They contain the field profiles of a Gaussian mode and a waveguide mode.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=2496b018">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">waveguide_mode_data</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">ModeSolverData</span><span class="o">.</span><span class="n">from_hdf5</span><span class="p">(</span><span class="s2">"misc/waveguide_mode_data.h5"</span><span class="p">)</span>
<span class="n">gaussian_beam_data</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">SimulationData</span><span class="o">.</span><span class="n">from_hdf5</span><span class="p">(</span><span class="s2">"misc/gaussian_beam_data.h5"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a19a110d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Before calculating the overlap, let's plot the fields to visualize them.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=87be6223">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">abs</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"z"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_8.png"/>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=296cbec0">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">]</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">abs</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"z"</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_9.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=53a79f86">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>From the field profiles, we can see that the waveguide mode and the Gaussian mode have a similar mode area so they should have a significant overlap.</p>
<p>Now we calculate the overlap using <code>outer_dot</code> and plot the result in dB.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8416786d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">overlap</span> <span class="o">=</span> <span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">outer_dot</span><span class="p">(</span><span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span class="n">overlap</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">overlap</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Wavelength ($\mu m$)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Overlap integral (dB)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_10.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=11a00ab9">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>For demonstration purposes, we can also perform the integral manually using the <code>integrate</code> method in <code>xarray</code>. The overlap integral is given by</p>
<p>$$
\frac{1}{4} \left(\mathbf{E}_1 \times \mathbf{H}_2^* - \mathbf{H}_1 \times \mathbf{E}_2^* \right) dA,
$$</p>
<p>where $\mathbf{E}_1$ and $\mathbf{H}_1$ are the electric and magnetic fields of the first mode, $\mathbf{E}_2$ and $\mathbf{H}_2$ are the fields of the second mode, and * denotes complex conjugation.</p>
<p>One complication here is that the fields of the two modes might not share the same grid as they can be calculated from different simulations. The computation between different arrays does require them to share the same coordinates. In this situation, we can use the <code>interp_like</code> method to easily interpolate one array to the grid of the other array.</p>
<p>As expected, the result calculated this way is the same as that calculated from <code>outer_dot</code> above.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=47c576a6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Ey_wg</span> <span class="o">=</span> <span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Ez_wg</span> <span class="o">=</span> <span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">Ez</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hy_wg</span> <span class="o">=</span> <span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">Hy</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Hz_wg</span> <span class="o">=</span> <span class="n">waveguide_mode_data</span><span class="o">.</span><span class="n">Hz</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Ey_gauss</span> <span class="o">=</span> <span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">]</span><span class="o">.</span><span class="n">Ey</span><span class="o">.</span><span class="n">interp_like</span><span class="p">(</span><span class="n">Ey_wg</span><span class="p">)</span>
<span class="n">Ez_gauss</span> <span class="o">=</span> <span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">]</span><span class="o">.</span><span class="n">Ez</span><span class="o">.</span><span class="n">interp_like</span><span class="p">(</span><span class="n">Ey_wg</span><span class="p">)</span>
<span class="n">Hy_gauss</span> <span class="o">=</span> <span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">]</span><span class="o">.</span><span class="n">Hy</span><span class="o">.</span><span class="n">interp_like</span><span class="p">(</span><span class="n">Ey_wg</span><span class="p">)</span>
<span class="n">Hz_gauss</span> <span class="o">=</span> <span class="n">gaussian_beam_data</span><span class="p">[</span><span class="s2">"monitor_0"</span><span class="p">]</span><span class="o">.</span><span class="n">Hz</span><span class="o">.</span><span class="n">interp_like</span><span class="p">(</span><span class="n">Ey_wg</span><span class="p">)</span>

<span class="n">e_self_x_h_other</span> <span class="o">=</span> <span class="n">Ey_wg</span> <span class="o">*</span> <span class="n">Hz_gauss</span> <span class="o">-</span> <span class="n">Ez_wg</span> <span class="o">*</span> <span class="n">Hy_gauss</span>
<span class="n">h_self_x_e_other</span> <span class="o">=</span> <span class="n">Hy_wg</span> <span class="o">*</span> <span class="n">Ez_gauss</span> <span class="o">-</span> <span class="n">Hz_wg</span> <span class="o">*</span> <span class="n">Ey_gauss</span>

<span class="n">integrand</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">e_self_x_h_other</span> <span class="o">-</span> <span class="n">h_self_x_e_other</span><span class="p">)</span>

<span class="n">overlap</span> <span class="o">=</span> <span class="n">integrand</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="p">[</span><span class="s2">"y"</span><span class="p">,</span> <span class="s2">"z"</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">td</span><span class="o">.</span><span class="n">C_0</span> <span class="o">/</span> <span class="n">overlap</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">overlap</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Wavelength ($\mu m$)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Overlap integral (dB)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/XarrayTutorial/XarrayTutorial_11.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=8c74c85e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Besides the overlap integral shown above, in other example notebooks we also demonstrated how to perform integrals to calculate the <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/CavityFOM/" target="_blank">cavity mode volume</a> and the <a href="https://www.flexcompute.com/tidy3d/examples/notebooks/BistablePCCavity/" target="_blank">nonlinear feedback parameter</a>.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=1beb9fb6">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Closing-Remarks">Closing Remarks<a class="anchor-link" href="#Closing-Remarks">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ff72fe43">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In this tutorial, we demonstrated various futures commonly used in Tidy3D's data postprocessing and visualization. We used data from <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.FieldMonitor.html" target="_blank">FieldMonitor</a>, <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.FluxMonitor.html" target="_blank">FluxMonitor</a>, <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.ModeMonitor.html" target="_blank">ModeMonitor</a>, and <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.plugins.mode.ModeSolver.html" target="_blank">ModeSolver</a> as examples. However, the methods are general and equally applicable to data from <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.DiffractionMonitor.html" target="_blank">DiffractionMonitor</a>, <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.FieldProjectionCartesianMonitor.html" target="_blank">FieldProjectionCartesianMonitor</a>, and so on.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=18166436">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</main>
</body>
</html>
