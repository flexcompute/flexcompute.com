---
author: Tom Chen
custom_css:
- learning-center/fdtd101
- learning-center/menu
- learning-center/home
custom_font: font2
description: This notebook contains pre-defined functions used to construct commonly
  used photonic integrated circuit (PIC) components.
layout: learning-center/example-library
menu_config:
  collapsed: true
  selected: Tidy3D Python
metadata:
  category: Structures
  enable_more_examples: false
  more_examples:
  - name: Importing GDS files
    path: notebooks/GDSImport/
  - name: Importing STL files
    path: notebooks/STLImport/
  - name: Defining self-intersecting polygons
    path: notebooks/SelfIntersectingPolyslab/
  pagination:
    next:
      name: Defining common photonic crystal structures
      path: notebooks/PhotonicCrystalsComponents/
    previous:
      name: Defining self-intersecting polygons
      path: notebooks/SelfIntersectingPolyslab/
  type: python-tutorial
page_title: Defining common integrated photonic components
source_link: https:/docs.flexcompute.com/projects/tidy3d/en/latest/_sources/notebooks/PICComponents.ipynb
tags:
- photonic integrated circuit
- PIC
- waveguide
- linear taper
- ring
- race track
- s-bend
- circular bend
- directional coupler
- tidy3d
- fdtd
title: Defining Common Integrated Photonic Components | Flexcompute
---


<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="/assets/tidy3d/examples/css/example-notebook.css" rel="stylesheet"/>





<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>

<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      maxEdges: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        let { svg } = await mermaid.render(id, raw, el);
        svg = cleanMermaidSvg(svg);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }


    /**
     * Post-process to ensure mermaid diagrams contain only valid SVG and XHTML.
     */
    function cleanMermaidSvg(svg) {
      return svg.replace(RE_VOID_ELEMENT, replaceVoidElement);
    }


    /**
     * A regular expression for all void elements, which may include attributes and
     * a slash.
     *
     * @see https://developer.mozilla.org/en-US/docs/Glossary/Void_element
     *
     * Of these, only `<br>` is generated by Mermaid in place of `\n`,
     * but _any_ "malformed" tag will break the SVG rendering entirely.
     */
    const RE_VOID_ELEMENT =
      /<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;

    /**
     * Ensure a void element is closed with a slash, preserving any attributes.
     */
    function replaceVoidElement(match, tag, rest) {
      rest = rest.trim();
      if (!rest.endsWith('/')) {
        rest = `${rest} /`;
      }
      return `<${tag} ${rest}>`;
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>

</head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=5f6f8760">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a0655b15">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>This notebook contains pre-defined functions used to construct commonly used photonic integrated circuit (PIC) components, including straight waveguide, linear taper, ring, race track, s-bend, circular bend, and directional coupler. These components are defined using the <a href="https://heitzmann.github.io/gdstk/" target="_blank">gdstk</a> library as it offers a convenient and flexible way to construct curved paths. Users can directly copy these pre-defined functions to your own script and use them directly in building your simulations. More importantly, users can learn the workflow from these examples and build your own Tidy3D Structures using the same principles.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=327ff859">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tidy3d</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">import</span> <span class="nn">gdstk</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=c507c933">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Straight-Waveguide">Straight Waveguide<a class="anchor-link" href="#Straight-Waveguide">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=4b5b614d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Straight strip waveguides are the most fundamental building block of any PIC. The function <code>straight_waveguide</code> returns a Tidy3D <a href="https://docs.flexcompute.com/projects/tidy3d/en/latest/_autosummary/tidy3d.Structure.html" target="_blank">Structure</a> of a straight waveguide. The waveguide is specified by the starting position and the ending position. It only supports waveguides parallel to the $xy$ plane.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=525d359d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">straight_waveguide</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">wg_width</span><span class="p">,</span> <span class="n">wg_thickness</span><span class="p">,</span> <span class="n">medium</span><span class="p">,</span> <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a straight strip waveguide and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of the waveguide starting position (um)</span>
<span class="sd">    y0: y coordinate of the waveguide starting position (um)</span>
<span class="sd">    z0: z coordinate of the waveguide starting position (um)</span>
<span class="sd">    x1: x coordinate of the waveguide end position (um)</span>
<span class="sd">    y1: y coordinate of the waveguide end position (um)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"waveguide"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># define a path</span>
    <span class="n">path</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>

    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># define geometry from the gds cell</span>
    <span class="n">wg_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define tidy3d structure of the bend</span>
    <span class="n">wg</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">wg_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wg</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=8fa68089">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">Si</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">material_library</span><span class="p">[</span><span class="s2">"cSi"</span><span class="p">][</span><span class="s2">"Li1993_293K"</span><span class="p">]</span>

<span class="n">wg</span> <span class="o">=</span> <span class="n">straight_waveguide</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">x1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">y1</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">wg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">wg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_1.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a02f2f77">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Linear-Waveguide-Taper">Linear Waveguide Taper<a class="anchor-link" href="#Linear-Waveguide-Taper">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=1fee1f1b">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Linear waveguide tapers can be defined in a similar way. Two parameters - width at the start and width at the end of the taper, need to be specified.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=35ef5af1">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">taper_waveguide</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">wg_width_0</span><span class="p">,</span> <span class="n">wg_width_1</span><span class="p">,</span> <span class="n">wg_thickness</span><span class="p">,</span> <span class="n">medium</span><span class="p">,</span> <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a linear waveguide taper and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of the waveguide starting position (um)</span>
<span class="sd">    y0: y coordinate of the waveguide starting position (um)</span>
<span class="sd">    z0: z coordinate of the waveguide starting position (um)</span>
<span class="sd">    x1: x coordinate of the waveguide end position (um)</span>
<span class="sd">    y1: y coordinate of the waveguide end position (um)</span>
<span class="sd">    wg_width_0: width of the waveguide in the beginning (um)</span>
<span class="sd">    wg_width_1: width of the waveguide in the end (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"taper"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width_0</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># define a path</span>
    <span class="n">path</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="n">wg_width_1</span><span class="p">)</span>

    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># define geometry from the gds cell</span>
    <span class="n">taper_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define tidy3d structure of the bend</span>
    <span class="n">taper</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">taper_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">taper</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=3398ad4e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">taper</span> <span class="o">=</span> <span class="n">taper_waveguide</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">x1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">y1</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">wg_width_0</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
    <span class="n">wg_width_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">taper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">taper</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_2.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a3e47485">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Ring">Ring<a class="anchor-link" href="#Ring">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=6c514feb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Rings are commonly used structures in PIC to construct resonators. Due to the hole, we can not define one single structure for the ring. Instead, we define two half rings and combine them to make one full ring.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=320793eb">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ring_resonator</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">,</span>
    <span class="n">z0</span><span class="p">,</span>
    <span class="n">R</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="p">,</span>
    <span class="n">medium</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a ring and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of center of the ring (um)</span>
<span class="sd">    y0: y coordinate of center of the ring (um)</span>
<span class="sd">    z0: z coordinate of center of the ring (um)</span>
<span class="sd">    R: radius of the ring (um)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"top"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="c1"># define a path</span>
    <span class="n">path_top</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">R</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sidewall_angle</span><span class="p">)),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">path_top</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># make the top half of the ring</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path_top</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># the reference plane depends on the sign of the sidewall_angle</span>
    <span class="k">if</span> <span class="n">sidewall_angle</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">reference_plane</span> <span class="o">=</span> <span class="s2">"top"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_plane</span> <span class="o">=</span> <span class="s2">"bottom"</span>

    <span class="c1"># define top half ring geometry</span>
    <span class="n">ring_top_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
        <span class="n">reference_plane</span><span class="o">=</span><span class="n">reference_plane</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># similarly for the bottom half of the ring</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"bottom"</span><span class="p">)</span>
    <span class="n">path_bottom</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">R</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sidewall_angle</span><span class="p">)),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="n">path_bottom</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path_bottom</span><span class="p">)</span>

    <span class="n">ring_bottom_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
        <span class="n">reference_plane</span><span class="o">=</span><span class="n">reference_plane</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define ring structure</span>
    <span class="n">ring</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">GeometryGroup</span><span class="p">(</span><span class="n">geometries</span><span class="o">=</span><span class="n">ring_bottom_geo</span> <span class="o">+</span> <span class="n">ring_top_geo</span><span class="p">),</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">ring</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=c364052e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ring</span> <span class="o">=</span> <span class="n">ring_resonator</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ring</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ring</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_3.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=24c7ac68">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Race-Track">Race Track<a class="anchor-link" href="#Race-Track">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=a777c99e">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Similar to rings, race tracks are commonly used to construct resonators. The way to define a race track is similar to defining a ring.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=c51c6344">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">race_track_resonator</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">,</span>
    <span class="n">z0</span><span class="p">,</span>
    <span class="n">R</span><span class="p">,</span>
    <span class="n">wg_length</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="p">,</span>
    <span class="n">medium</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a race track and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of center of the race track (um)</span>
<span class="sd">    y0: y coordinate of center of the race track (um)</span>
<span class="sd">    z0: z coordinate of center of the race track (um)</span>
<span class="sd">    R: radius of the circular part (um)</span>
<span class="sd">    wg_length: length of the straight waveguide (um)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"top"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="c1"># define a path</span>
    <span class="n">path_top</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">wg_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
        <span class="n">wg_width</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sidewall_angle</span><span class="p">)),</span>
        <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># make the top half of the race track</span>
    <span class="n">path_top</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">path_top</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">wg_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">path_top</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path_top</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># the reference plane depends on the sign of the sidewall_angle</span>
    <span class="k">if</span> <span class="n">sidewall_angle</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">reference_plane</span> <span class="o">=</span> <span class="s2">"top"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_plane</span> <span class="o">=</span> <span class="s2">"bottom"</span>

    <span class="c1"># define top half race track geometry</span>
    <span class="n">race_track_top_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
        <span class="n">reference_plane</span><span class="o">=</span><span class="n">reference_plane</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># similarly for the bottom half of the race track</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"bottom"</span><span class="p">)</span>
    <span class="n">path_bottom</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
        <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">wg_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
        <span class="n">wg_width</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sidewall_angle</span><span class="p">)),</span>
        <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">path_bottom</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">path_bottom</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">wg_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">path_bottom</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path_bottom</span><span class="p">)</span>

    <span class="n">race_track_bottom_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
        <span class="n">reference_plane</span><span class="o">=</span><span class="n">reference_plane</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define race track structure</span>
    <span class="n">race_track</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">GeometryGroup</span><span class="p">(</span><span class="n">geometries</span><span class="o">=</span><span class="n">race_track_bottom_geo</span> <span class="o">+</span> <span class="n">race_track_top_geo</span><span class="p">),</span>
        <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">race_track</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=f25e68dd">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">race_track</span> <span class="o">=</span> <span class="n">race_track_resonator</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">wg_length</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">race_track</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">race_track</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_4.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=003fa866">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Waveguide-Cosine-S-bend">Waveguide Cosine S-bend<a class="anchor-link" href="#Waveguide-Cosine-S-bend">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=94704969">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Waveguide s-bends are commonly used in various PIC devices. The function <code>cosine_sbend</code> defines an s-bend using the cosine bend profile. Other s-bend profiles such as <code>circular</code>, <code>sigmoid</code>, or <code>tanh</code> can be incorporated in the same way. The cosine s-bend here interfaces with waveguides in the $x$ or $y$ direction and its bend direction can be controlled by the <code>mirror</code> parameter.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=c46daa1c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cosine_sbend</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">,</span>
    <span class="n">z0</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="p">,</span>
    <span class="n">bend_length</span><span class="p">,</span>
    <span class="n">bend_height</span><span class="p">,</span>
    <span class="n">medium</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span>
    <span class="n">mirror</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a cosine waveguide bend and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of the bend starting position (um)</span>
<span class="sd">    y0: y coordinate of the bend starting position (um)</span>
<span class="sd">    z0: z coordinate of the bend starting position (um)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    bend_length: length of the bend (um)</span>
<span class="sd">    bend_height: height of the bend (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    orientation: orientation of the bend, either 'x' or 'y'</span>
<span class="sd">    mirror: whether to mirror bend</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"bend"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># define a path</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">"x"</span><span class="p">:</span>
        <span class="c1"># define cosine bend for x orientation</span>
        <span class="n">path</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">bend_length</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
            <span class="n">offset</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="n">bend_height</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">bend_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># check if mirroring is needed</span>
        <span class="k">if</span> <span class="n">mirror</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">mirror</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">"y"</span><span class="p">:</span>
        <span class="c1"># define cosine bend for x orientation</span>
        <span class="n">path</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">bend_length</span><span class="p">),</span>
            <span class="n">offset</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="n">bend_height</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">bend_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># check if mirroring is needed</span>
        <span class="k">if</span> <span class="n">mirror</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">mirror</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>

    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># define geometry from the gds cell</span>
    <span class="n">bend_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define tidy3d structure of the bend</span>
    <span class="n">bend</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">bend_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bend</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=7af6f9f8">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bend</span> <span class="o">=</span> <span class="n">cosine_sbend</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">bend_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">bend_height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span>
    <span class="n">mirror</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">bend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">bend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_5.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=b2c06223">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Waveguide-Circular-Bend">Waveguide Circular Bend<a class="anchor-link" href="#Waveguide-Circular-Bend">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=ede9721d">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Circular bends with an arbitrary bending angle and radius can be defined using the <code>circular_bend</code> function. Similar to the s-bend, the circular bend here interfaces with waveguides in the $x$ or $y$ direction and its bend direction can be controlled by the <code>mirror</code> parameter.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=2207f24f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">circular_bend</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">,</span>
    <span class="n">z0</span><span class="p">,</span>
    <span class="n">R</span><span class="p">,</span>
    <span class="n">bend_angle</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="p">,</span>
    <span class="n">medium</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">"x"</span><span class="p">,</span>
    <span class="n">mirror</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a circular waveguide bend and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of the bend starting position (um)</span>
<span class="sd">    y0: y coordinate of the bend starting position (um)</span>
<span class="sd">    z0: z coordinate of the bend starting position (um)</span>
<span class="sd">    R: radius of the circular bend (um)</span>
<span class="sd">    bend_angle: angle of the bend (rad)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    orientation: orientation of the bend, either 'x' or 'y'</span>
<span class="sd">    mirror: whether to mirror bend</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"bend"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">wg_width</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># define a path</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">"x"</span><span class="p">:</span>
        <span class="c1"># define cosine bend for x orientation</span>
        <span class="n">path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">bend_angle</span><span class="p">)</span>
        <span class="c1"># check if mirroring is needed</span>
        <span class="k">if</span> <span class="n">mirror</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">mirror</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">"y"</span><span class="p">:</span>
        <span class="c1"># define cosine bend for x orientation</span>
        <span class="n">path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">bend_angle</span><span class="p">)</span>
        <span class="c1"># check if mirroring is needed</span>
        <span class="k">if</span> <span class="n">mirror</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">mirror</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">))</span>

    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># add path to the cell</span>

    <span class="c1"># define geometry from the gds cell</span>
    <span class="n">bend_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define tidy3d structure of the bend</span>
    <span class="n">bend</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">bend_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bend</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=838c2fd7">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bend</span> <span class="o">=</span> <span class="n">circular_bend</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">bend_angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">"y"</span><span class="p">,</span>
    <span class="n">mirror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">bend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">bend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_6.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=3961958f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Directional-Coupler">Directional Coupler<a class="anchor-link" href="#Directional-Coupler">¶</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell" id="cell-id=0b9ebc83">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>A directional coupler (DC) composes of two waveguides brought into close proximity for a certain length. The function <code>directional_coupler</code> defines a symmetric DC.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=0665ba5f">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">directional_coupler</span><span class="p">(</span>
    <span class="n">x0</span><span class="p">,</span>
    <span class="n">y0</span><span class="p">,</span>
    <span class="n">z0</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="p">,</span>
    <span class="n">wg_spacing_in</span><span class="p">,</span>
    <span class="n">wg_spacing_coup</span><span class="p">,</span>
    <span class="n">wg_length</span><span class="p">,</span>
    <span class="n">coup_length</span><span class="p">,</span>
    <span class="n">bend_length</span><span class="p">,</span>
    <span class="n">medium</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function defines a directional coupler and returns the tidy3d structure of it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x0: x coordinate of directional coupler center (um)</span>
<span class="sd">    y0: y coordinate of directional coupler center (um)</span>
<span class="sd">    z0: z coordinate of directional coupler center (um)</span>
<span class="sd">    wg_width: width of the waveguide (um)</span>
<span class="sd">    wg_thickness: thickness of the waveguide (um)</span>
<span class="sd">    wg_spacing_in : spacing between the input straight waveguides (um)</span>
<span class="sd">    wg_spacing_coup: gap size of the coupling region (um)</span>
<span class="sd">    wg_length: length of the input straight waveguides (um)</span>
<span class="sd">    coup_length：length of the coupling region (um)</span>
<span class="sd">    bend_length: length of the bending (um)</span>
<span class="sd">    medium: medium of the waveguide</span>
<span class="sd">    sidewall_angle: side wall angle of the waveguide (rad)</span>
<span class="sd">    """</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">"dc"</span><span class="p">)</span>  <span class="c1"># define a gds cell</span>

    <span class="c1"># define a path</span>
    <span class="n">coup</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
        <span class="p">(</span><span class="o">-</span><span class="n">wg_length</span> <span class="o">-</span> <span class="n">bend_length</span> <span class="o">-</span> <span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">),</span>
        <span class="n">wg_width</span><span class="p">,</span>
        <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">datatype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">coup</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="o">-</span><span class="n">bend_length</span> <span class="o">-</span> <span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">))</span>

    <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">wg_spacing_in</span> <span class="o">-</span> <span class="n">wg_spacing_coup</span> <span class="o">-</span> <span class="n">wg_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span>

    <span class="n">coup</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span>
        <span class="p">(</span><span class="o">-</span><span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">),</span> <span class="n">offset</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span>
    <span class="p">)</span>

    <span class="n">coup</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">))</span>

    <span class="n">coup</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span>
        <span class="p">(</span><span class="n">bend_length</span> <span class="o">+</span> <span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">),</span>
        <span class="n">offset</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">coup</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="n">wg_length</span> <span class="o">+</span> <span class="n">bend_length</span> <span class="o">+</span> <span class="n">coup_length</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x0</span><span class="p">,</span> <span class="n">wg_spacing_in</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y0</span><span class="p">))</span>

    <span class="c1"># add path to the cell</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">coup</span><span class="p">)</span>

    <span class="c1"># add the mirrored path to the cell</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">coup</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">mirror</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)))</span>

    <span class="c1"># define geometry from the gds cell</span>
    <span class="n">dc_geo</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">PolySlab</span><span class="o">.</span><span class="n">from_gds</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">gds_layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">slab_bounds</span><span class="o">=</span><span class="p">(</span><span class="n">z0</span> <span class="o">-</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">wg_thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">sidewall_angle</span><span class="o">=</span><span class="n">sidewall_angle</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># define tidy3d structure of the bend</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">td</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">td</span><span class="o">.</span><span class="n">GeometryGroup</span><span class="p">(</span><span class="n">geometries</span><span class="o">=</span><span class="n">dc_geo</span><span class="p">),</span> <span class="n">medium</span><span class="o">=</span><span class="n">medium</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dc</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell" id="cell-id=5b74606c">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">directional_coupler</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">y0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">z0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">wg_spacing_in</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">wg_width</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span>
    <span class="n">wg_thickness</span><span class="o">=</span><span class="mf">0.22</span><span class="p">,</span>
    <span class="n">wg_spacing_coup</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">coup_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">bend_length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">wg_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">medium</span><span class="o">=</span><span class="n">Si</span><span class="p">,</span>
    <span class="n">sidewall_angle</span><span class="o">=</span><span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">dc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">dc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output" tabindex="0">
<img alt="No description has been provided for this image" class="" src="/assets/tidy3d/examples/image/PICComponents/PICComponents_7.png"/>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs" id="cell-id=76d09205">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">[ ]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</main>
</body>
</html>
