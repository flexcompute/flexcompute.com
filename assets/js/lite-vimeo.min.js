class LiteVimeoEmbed extends HTMLElement{constructor(){super(),this.iframeLoaded=!1,this.setupDom()}static get observedAttributes(){return["videoid"]}connectedCallback(){this.addEventListener("pointerover",LiteVimeoEmbed.warmConnections,{once:!0}),this.addEventListener("click",(()=>this.addIframe()))}get videoId(){return encodeURIComponent(this.getAttribute("videoid")||"")}set videoId(e){this.setAttribute("videoid",e)}get videoTitle(){return this.getAttribute("videotitle")||"Video"}set videoTitle(e){this.setAttribute("videotitle",e)}get videoPlay(){return this.getAttribute("videoPlay")||"Play"}set videoPlay(e){this.setAttribute("videoPlay",e)}get videoStartAt(){return this.getAttribute("videoPlay")||"0s"}set videoStartAt(e){this.setAttribute("videoPlay",e)}get autoLoad(){return this.hasAttribute("autoload")}set autoLoad(e){e?this.setAttribute("autoload",""):this.removeAttribute("autoload")}get autoPlay(){return this.hasAttribute("autoplay")}set autoPlay(e){e?this.setAttribute("autoplay","autoplay"):this.removeAttribute("autoplay")}setupDom(){this.attachShadow({mode:"open"}).innerHTML='\n<style>\n:host {\ncontain: content;\ndisplay: block;\nposition: relative;\nwidth: 100%;\npadding-bottom: calc(100% / (16 / 9));\n}\n\n#frame, #fallbackPlaceholder, iframe {\nposition: absolute;\nwidth: 100%;\nheight: 100%;\n}\n\n#frame {\ncursor: pointer;\n}\n\n#fallbackPlaceholder {\nobject-fit: cover;\n}\n\n#frame::before {\ncontent: \'\';\ndisplay: block;\nposition: absolute;\ntop: 0;\nbackground-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==);\nbackground-position: top;\nbackground-repeat: repeat-x;\nheight: 60px;\npadding-bottom: 50px;\nwidth: 100%;\ntransition: all 0.2s cubic-bezier(0, 0, 0.2, 1);\nz-index: 1;\n}\n/* play button */\n.lvo-playbtn {\nwidth: 70px;\nheight: 46px;\nbackground-color: #212121;\nz-index: 1;\nopacity: 0.8;\nborder-radius: 10%;\ntransition: all 0.2s cubic-bezier(0, 0, 0.2, 1);\nborder: 0;\n}\n#frame:hover .lvo-playbtn {\nbackground-color: rgb(98, 175, 237);\nopacity: 1;\n}\n/* play button triangle */\n.lvo-playbtn:before {\ncontent: \'\';\nborder-style: solid;\nborder-width: 11px 0 11px 19px;\nborder-color: transparent transparent transparent #fff;\n}\n.lvo-playbtn,\n.lvo-playbtn:before {\nposition: absolute;\ntop: 50%;\nleft: 50%;\ntransform: translate3d(-50%, -50%, 0);\n}\n\n/* Post-click styles */\n.lvo-activated {\ncursor: unset;\n}\n\n#frame.lvo-activated::before,\n.lvo-activated .lvo-playbtn {\ndisplay: none;\n}\n</style>\n<div id="frame">\n<picture>\n<source id="webpPlaceholder" type="image/webp">\n<source id="jpegPlaceholder" type="image/jpeg">\n<img id="fallbackPlaceholder" referrerpolicy="origin">\n</picture>\n<button class="lvo-playbtn"></button>\n</div>\n',this.domRefFrame=this.shadowRoot.querySelector("#frame"),this.domRefImg={fallback:this.shadowRoot.querySelector("#fallbackPlaceholder"),webp:this.shadowRoot.querySelector("#webpPlaceholder"),jpeg:this.shadowRoot.querySelector("#jpegPlaceholder")},this.domRefPlayButton=this.shadowRoot.querySelector(".lvo-playbtn")}setupComponent(){this.initImagePlaceholder(),this.domRefPlayButton.setAttribute("aria-label",`${this.videoPlay}: ${this.videoTitle}`),this.setAttribute("title",`${this.videoPlay}: ${this.videoTitle}`),this.autoLoad&&this.initIntersectionObserver()}attributeChangedCallback(e,t,i){if("videoid"===e)t!==i&&(this.setupComponent(),this.domRefFrame.classList.contains("lvo-activated")&&(this.domRefFrame.classList.remove("lvo-activated"),this.shadowRoot.querySelector("iframe").remove()))}addIframe(){if(!this.iframeLoaded){let e=this.autoLoad&&this.autoPlay||!this.autoLoad?"autoplay=1":"";const t=`\n<iframe frameborder="0"\nallow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" \nallowfullscreen src="${new URL(`/video/${this.videoId}?${e}&#t=${this.videoStartAt}`,"https://player.vimeo.com/")}"></iframe>`;this.domRefFrame.insertAdjacentHTML("beforeend",t),this.domRefFrame.classList.add("lvo-activated"),this.iframeLoaded=!0}}async initImagePlaceholder(){LiteVimeoEmbed.addPrefetch("preconnect","https://i.vimeocdn.com/");let e=`https://vimeo.com/api/v2/video/${this.videoId}.json`,t=(await(await fetch(e)).json())[0].thumbnail_large,i=t.substr(t.lastIndexOf("/")+1).split("_")[0];const o=`https://i.vimeocdn.com/video/${i}.webp?mw=1100&mh=619&q=70`,n=`https://i.vimeocdn.com/video/${i}.jpg?mw=1100&mh=619&q=70`;this.domRefImg.webp.srcset=o,this.domRefImg.jpeg.srcset=n,this.domRefImg.fallback.src=n,this.domRefImg.fallback.setAttribute("aria-label",`${this.videoPlay}: ${this.videoTitle}`),this.domRefImg.fallback.setAttribute("alt",`${this.videoPlay}: ${this.videoTitle}`)}initIntersectionObserver(){"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&!this.iframeLoaded&&(LiteVimeoEmbed.warmConnections(),this.addIframe(),t.unobserve(this))}))}),{root:null,rootMargin:"0px",threshold:0}).observe(this)}static addPrefetch(e,t,i){const o=document.createElement("link");o.rel=e,o.href=t,i&&(o.as=i),o.crossOrigin="true",document.head.append(o)}static warmConnections(){LiteVimeoEmbed.preconnected||(LiteVimeoEmbed.addPrefetch("preconnect","https://f.vimeocdn.com"),LiteVimeoEmbed.addPrefetch("preconnect","https://player.vimeo.com"),LiteVimeoEmbed.addPrefetch("preconnect","https://i.vimeocdn.com"),LiteVimeoEmbed.preconnected=!0)}}LiteVimeoEmbed.preconnected=!1;export{LiteVimeoEmbed};customElements.define("lite-vimeo",LiteVimeoEmbed);
